
%%
%%::::::::::::::::::::::::::::commands
\input{cmd-text}
\input{cmd-math}

%%
%%::::::::::::::::::::::::::::BRICK1
\chapter{BRICK1}
\begin{flushright}
\emph{``Mr.\@ President, tear down this BRICK1 element!''}\\
\emph{``Et tu, BRICK1?''}\\
\emph{``Ceterum censeo saxum BRICK1 esse delendum!''}
\end{flushright}

\subitempart{About}\\

Input sequences are denoted by applying EBNF, see Sec.~\ref{inparams:sec:ebnf}.

\subitempart{Text input} `\cnl' is for line continuation
\begin{quote}
\cod{BRICK1} \cnl \\
\cgb \cod{HEX8} \cor \cod{HEX20} \cge $int_1$ $\ldots$ $int_\enod$ \cnl \\
\cod{MAT} $int_1$ \cnl \\
\cod{GP} $int_1$ $int_2$ $int_3$ \cnl \\
\cod{GP\_TET} $int_1$ \cnl \chs Gauss points tetrahedra (not read in) \\
\cod{HYP} \cgb \cod{0} \cor \cod{3} \cor \cod{6} \cor \cod{9} \cge \cnl \\
\cod{FORM} \cgb \cod{0} \cor \cod{1} \cor \cod{2} \cge \cnl \\
\cod{STRESSES} \cgb \cod{NoBStr} \cor \cod{GPXYZ} \cor \cod{GPRST} \cor \cod{GP123} \cor
\cod{NDXYZ} \cor \cod{NDRST} \cor \cod{ND123} \cor \cod{NDEQS} \cge \cnl \\
\ccb \cod{TSI\_COUPTYP} \cgb \cod{None} \cor \cod{Thermconf} \cor
\cod{Thermcreate} \cge \cce
\end{quote}

\subitempart{Discretisation types} hex8, hex20

Hex27 fails, shape function derivatives are not set.

Tetrahedron tet4, tet10 can be read in, however, the element routine cannot
build any tetrahedron quantities.

\subitempart{Materials} The material \cod{MAT} index can refer back to
\begin{description}
\item[\cod{MAT\_Struct\_StVenantKirchhoff}] linear elastic
\item[\cod{MAT\_Struct\_STVENPOR}] porous linear elastic
\item[\cod{MAT\_MFOC}] open cell metal foam linear elastic
\item[\cod{MAT\_MFC}] closed cell metal foam linear elastic
\item[\cod{MAT\_NeoHMFCC}] foam, closed cell, based on modified Neo Hook
\item[\cod{MAT\_Struct\_NeoHooke}] kompressible neo-hooke
\item[\cod{MAT\_MisesPlastic}] von mises material law
\item[\cod{MAT\_Struct\_Orthotropic}] elastic orthotropic material law
\item[\cod{m\_pl\_mises\_ls}] \fail{No input!} von mises material law - large
  strains
\item[\cod{MAT\_HYPER\_POLYCONVEX}] 
\end{description}

\subitempart{Gauss points}
\cod{GP} $int_1$ $int_2$ $int_3$ set the number of Gauss--Legendre points for
the $3$ space dimenions; for each $int_1, int_2, int_3 \in [1,6]$

\subitempart{Single- or multi-field approach}
\begin{description}
\item[\cod{HYB 0}] purely displacement-based (works, obviously)
\item[\cod{HYB \cgb 3 \cor 6 \cor 9 \cge}] \fail{EAS untested --- works possibly}
\end{description}

\subitempart{Spatial kinematic}
\begin{description}
\item[\cod{FORM 0}] Linear
\item[\cod{FORM 1}] Updated Lagrangean formulation \fail{Not implemented}
\item[\cod{FORM 2}] Total Lagrangean formulation
\end{description}

\subitempart{Stresses}
\begin{description}
\item[\cod{STRESSES NoBStr}] No stresses
\item[\cod{STRESSES GPXYZ}] Stress $XYZ$-oriented at Gauss points
\item[\cod{STRESSES GPRST}] Stress $rst$-oriented at Gauss points
\item[\cod{STRESSES GP123}] Principal stresses at Gauss points
\item[\cod{STRESSES NDXYZ}] Stress $XYZ$-oriented at element nodes
\item[\cod{STRESSES NDRST}] Stress $rst$-oriented at element nodes
\item[\cod{STRESSES ND123}] Principal stresses at element nodes
\item[\cod{STRESSES NDEQS}] Equivalent stresses at element nodes
\end{description}
The $XYZ$-frame is the material frame. The $rst$-frame is the parameter
frame.
\begin{enumerate}
\item All stress choices work for \cod{xxx.out} output
\item $XYZ$- and $rst$-oriented and equivalent stresses at nodes work for Gid
  \cod{xxx.flavia.res} output
\item $XYZ$-oriented stresses at Gauss points work for Gid
  \cod{xxx.flavia.res} output
\end{enumerate}

\subitempart{Thermo-structure-interaction (TSI)} Check WALL1 section

\subitempart{Neumann BC}\\
On nodes
\begin{quote}
%%\cod{-----------------------------------DESIGN POINT NEUMANN CONDITIONS}\\
\cod{E $int$} \cnl \chs Index of design entity\\
\cod{-} \cnl\\
\cod{\cgb none \cor $int$ \cge} \chs Curve index\\
\cod{\cgb 0 \cor 1 \cge 
     \cgb 0 \cor 1 \cge
     \cgb 0 \cor 1 \cge
     0 0 0} \cnl \chs Flag on/off condition \\
\cod{$real_1$ $real_2$ $real_3$ 0.0 0.0 0.0} \cnl \chs Value\\
\cod{Mid} \chs Reference surface
\end{quote}
\begin{enumerate}
\item Load vectors work.
\item Individual load curves are ignored : do not work.
\end{enumerate}

On lines
\begin{quote}
%%\cod{------------------------------------DESIGN LINE NEUMANN CONDITIONS}\\
\cod{E $int$} \cnl \chs Index of design entity\\
\cod{-} \cnl\\
\cod{\cgb none \cor $int$ \cge} \cnl \chs Curve index\\
\cod{\cgb 0 \cor 1 \cge 
     \cgb 0 \cor 1 \cge 
     \cgb 0 \cor 1 \cge
     0 0 0} \cnl \chs Flag on/off condition \\
\cod{$real_1$ $real_2$ $real_3$ 0.0 0.0 0.0} \cnl \chs Value\\
\cod{\cgb Live \cor Dead \cge} \cnl \chs Load type\\
\cod{Mid} \chs Reference surface
\end{quote}
\begin{enumerate}
\item Constant material loads work.
\item There is no difference between \cod{Live} and \cod{Dead}. All load types
refer to the undeformed/material frame.
\item Individual load curve is not applied.
\end{enumerate}

On surfaces
\begin{quote}
%%\cod{------------------------------------DESIGN SURF NEUMANN CONDITIONS}\\
\cod{E $int$} \cnl \chs Index of design entity\\
\cod{-} \cnl\\
\cod{\cgb none \cor $int$ \cge} \chs Curve\\
\cod{\cgb 0 \cor 1 \cge
     \cgb 0 \cor 1 \cge
     \cgb 0 \cor 1 \cge
     0 0 0} \cnl \chs Flag on/off condition \\
\cod{$real_1$ $real_2$ $real_3$ 0.0 0.0 0.0} \cnl \chs Value (without curve?)\\
\cod{\cgb Live \cor Dead \cor PrescribedDomainLoad \cor orthopressure \cge} \cnl \chs Load type\\
\cod{Mid} \chs Reference surface
\end{quote}
\begin{enumerate}
\item  There is no difference between \cod{Live}, \cod{Dead} and
  \cod{PrescribedDomainLoad}. All load types refer to the undeformed/material
  frame. 
\item Constant domain load referred to material frame works.
\item Load type \cod{orthopressure}, value must be $real_3$. Details
  $\to$ Lena. 
\item Individual load curve is ignored : does not work.
\item Reference surface is meaningless.
\end{enumerate}

On volume
\begin{quote}
%%\cod{-------------------------------------DESIGN VOL NEUMANN CONDITIONS}\\
\cod{E $int$} \cnl \chs Index of design entity\\
\cod{-} \cnl\\
\cod{\cgb none \cor $int$ \cge} \chs Curve\\
\cod{\cgb 0 \cor 1 \cge 
     \cgb 0 \cor 1 \cge 
     \cgb 0 \cor 1 \cge
     0 0 0} \cnl \chs Flag on/off condition \\
\cod{$real_1$ $real_2$ $real_3$ 0.0 0.0 0.0} \cnl \chs Value (without curve?)\\
\cod{\cgb Live \cor Dead \cge} \cnl \chs Load type\\
\cod{Mid} \chs Reference surface
\end{quote}
\begin{enumerate}
\item Constant domain load referred to material frame works.
\item  There is no difference between \cod{Live}, \cod{Dead}. All load types
  refer to the undeformed/material 
  frame. 
\item Individual load curve is ignored : does not work.
\end{enumerate}


\subitempart{Dirichlet BC}\\
On nodes
\begin{quote}
%%\cod{------------------------------------DESIGN POINT DIRICH CONDITIONS}
\cod{E $int$} \cnl \chs Index of design entity\\
\cod{-} \cnl \\
\cod{\cgb 0 \cor 1 \cge \cgb 0 \cor 1 \cge \cgb 0 \cor 1 \cge 0 0
  0} \cnl \chs Flag on/off condition \\
\cod{$real_1$ $real_2$ $real_3$ 0.0 0.0 0.0} \cnl \chs Value\\
\cod{\cgb none \cor $int_1$ \cge 
\cgb none \cor $int_2$ \cge
\cgb none \cor $int_3$ \cge
none none none} \cnl
\chs Prescr. displ. by `Load curve' index\\
\cod{$int_1$ $int_2$ $int_3$ 0 0 0} \chs Spatial distribution `Function'
\end{quote}
\begin{enumerate}
\item Constant prescribed displacements work.
\item Load-Curve-prescribed displacements work, in this case the values
  $real_1$ etc are \emph{multiplied} by the load curve
\item Spatial `Function'-distribution???
\end{enumerate}

On lines
\begin{quote}
%%\cod{-------------------------------------DESIGN LINE DIRICH CONDITIONS}\\
\cod{E $int$} \cnl \chs Index of design entity\\
\cod{-} \cnl \\
\cod{\cgb 0 \cor 1 \cge 
     \cgb 0 \cor 1 \cge 
     \cgb 0 \cor 1 \cge 
     0 0 0} \cnl \chs Flag on/off condition \\
\cod{$real_1$ $real_2$ $real_3$ 0.0 0.0 0.0} \cnl \chs Value\\
\cod{\cgb none \cor $int_1$ \cge
     \cgb none \cor $int_2$ \cge
     \cgb none \cor $int_3$ 
     none none none} \cnl
\chs prescribed displacement `Load curve'\\
\cod{$int_1$ $int_2$ $int_3$ 0 0 0} \chs Spatial distribution `Function'
\end{quote}
\begin{enumerate}
\item Constant prescribed displacements work.
\item Load-Curve-prescribed displacements work.
\item Spatial `Function'-scaling does not work 
\end{enumerate}

On surface
\begin{quote}
%%\cod{-------------------------------------DESIGN SURF DIRICH CONDITIONS}\\
\cod{E $int$} \cnl \chs Index of design entity\\
\cod{-} \cnl \\
\cod{\cgb 0 \cor 1 \cge 
     \cgb 0 \cor 1 \cge
     \cgb 0 \cor 1 \cge
     0 0 0} \cnl \chs Flag on/off condition \\
\cod{$real_1$ $real_2$ $real_3$ 0.0 0.0 0.0} \cnl \chs Value\\
\cod{\cgb none \cor $int_1$\cge
     \cgb none \cor $int_2$ \cge
     \cgb none \cor $int_3$ \cge
     none none none} \cnl \chs prescribed displacement `Load curve'\\
\cod{$int_1$ $int_2$ $int_3$ 0 0 0} \chs Spatial distribution `Function'
\end{quote}
\begin{enumerate}
\item Constant prescribed displacements work.
\item Load-Curve-prescribed displacements work.
\item Spatial `Function'-distribution???
\end{enumerate}

On volume
\begin{quote}
%%\cod{--------------------------------------DESIGN VOL DIRICH CONDITIONS}\\
\cod{E $int$} \cnl \chs Index of design entity\\
\cod{-} \cnl \\
\cod{\cgb 0 \cor 1 \cge 
     \cgb 0 \cor 1 \cge
     \cgb 0 \cor 1 \cge
     0 0 0} \cnl \chs Flag on/off condition \\
\cod{$real_1$ $real_2$ $real_3$ 0.0 0.0 0.0} \cnl \chs Value\\
\cod{\cgb none \cor $int_1$\cge
     \cgb none \cor $int_2$ \cge
     \cgb none \cor $int_3$ \cge
     none none none} \cnl \chs prescribed displacement `Load curve'\\
\cod{$int_1$ $int_2$ $int_3$ 0 0 0} \chs Spatial distribution `Function'
\end{quote}
\begin{enumerate}
\item Constant prescribed displacements work.
\item Load-Curve-prescribed displacements work.
\item Spatial `Function'-distribution???
\end{enumerate}


\subitempart{Dirichlet and Neumann BC --- status summary}\\
Explanation: `+' means working, `-' is for \fail{not
  implemented}, `0' is undetermined, ` ' does not apply
\begin{center}
\begin{tabular}{c|cccc|cccc|c}
  & \multicolumn{4}{c|}{Dirichlet BC} & \multicolumn{4}{c|}{Neumann BC}
  & Solution
\\
  & nod. & lin. & surf. & vol.
  & nod. & lin. & surf. & vol.
  & tested with
\\ \hline
  Curves 
  & + & + & + & + 
  & - & - & - & - 
  & Dyn. gen.-$\alpha$
\\
  Functions 
  & 0 & - & 0 & 0
  &  &  & &
  & Dyn. gen.-$\alpha$
\end{tabular}
\end{center}

\subitempart{Gid input} Data : Conditions : Single Layer : Volumes : Brick

\subitempart{Gid output}\\
Displacements can be shown for any discretisation type

Stresses can only be displayed for these combinations
\begin{enumerate}
\item hex8 \& $2\times2\times2$ Gauss points
\item hex20 \& $3\times3\times3$ Gauss points
\end{enumerate}

\subitempart{src/Input files}
\cod{c1\_elast.dat},
\cod{c1\_elast\_geonln.dat},
\cod{c1\_elast\_geonln\_sd.dat},
\cod{c1\_mat\_hyperpolyconvex.dat},
\cod{c1\_neum\_geonln.dat},
\cod{c1\_optfsd.dat},
\cod{c1\_plast\_mises.dat}

\subitempart{Suggestions}
\begin{enumerate}
\item Tetrahedra $\longrightarrow$ SOLID3
\item Nodal interpolation of stresses is very inefficient, consider recoding
\end{enumerate}

