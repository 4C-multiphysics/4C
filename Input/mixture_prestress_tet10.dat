//
// Maintainer: Amadeus Gebauer
//
-----------------------------------------------------------------------TITLE
Testcase for testing prestressing of constituents in the Mixture toolbox
-----------------------------------------------------------------PROBLEM TYP
PROBLEMTYP                      Structure
--------------------------------------------------------------DISCRETISATION
NUMSTRUCDIS                     1
--------------------------------------------------------------------------IO
OUTPUT_BIN                      Yes
STRUCT_DISP                     Yes
STRUCT_STRESS                   Yes
STRUCT_STRAIN                   Yes
FILESTEPS                       1000
----------------------------------------------------------STRUCTURAL DYNAMIC
DYNAMICTYP                      Statics
INT_STRATEGY                    Standard
PRESTRESS                       material_mulf                          
PRESTRESSTIME                   99
RESULTSEVRY                     1
RESEVRYERGY                     0
RESTARTEVRY                     1
TIMESTEP                        0.1
NUMSTEP                         990
MAXTIME                         40
TOLDISP                         1e-9
NORM_DISP                       Abs
TOLRES                          1e-9
NORM_RESF                       Abs
NORM_INCO                       Abs
NORMCOMBI_DISPPRES              And
NORMCOMBI_RESFINCO              And
NORMCOMBI_RESFDISP              And
MAXITER                         50
MINITER                         0
ITERNORM                        Inf
NLNSOL                          fullnewton
PREDICT                         ConstDis
LINEAR_SOLVER                   1
--------------------------------------------------------------------SOLVER 1
SOLVER                          UMFPACK
-----------------------------------------------DESIGN SURF DIRICH CONDITIONS
DSURF                           1
E 1 - NUMDOF 3 ONOFF 1 1 1 VAL 0.0 0.0 0.0 FUNCT 0 0 0
----------------------------------------------DESIGN SURF NEUMANN CONDITIONS
DSURF                           1
E 2 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 10.0 10.0 10.0 0.0 0.0 0.0 FUNCT 1 2 3 1 1 1 Live Mid
-------------------------------------------------------------------MATERIALS
MAT 1 MAT_MixtureElastHyper NUMCONST 2 MATIDSCONST 11 12 MASSFRAC 0.4 0.6 MATIDMIXTURERULE 10 DENS 0.1
MAT 10 MIX_GrowthRemodelMixtureRule GROWTH_TYPE 0

// Fiber constituent that already has a prestretch
MAT 11 MIX_Constituent_ExplicitRemodelFiber MATID 110 DECAY_TIME 101.0 GROWTH_CONSTANT 0.0 DEPOSITION_STRETCH 1.062
MAT 110 ELAST_CoupAnisoExpo K1 568.0 K2 11.2 GAMMA 0.0 K1COMP 568.0 K2COMP 11.2 ADAPT_ANGLE No INIT 1 STR_TENS_ID 1000

// 3D constituent with unknown prestretch
MAT 12 MIX_Constituent_ElastHyper_Damage NUMMAT 2 MATIDS 121 122 DAMAGE_FUNCT 4 PRESTRESS_STRATEGY 129
MAT 121 ELAST_IsoNeoHooke MUE 72.0
MAT 122 ELAST_VolSussmanBathe KAPPA 720.0
MAT 129 MIX_Prestress_Strategy_Iterative

// Structural tensor strategy
MAT 1000 ELAST_StructuralTensor STRATEGY Standard
----------------------------------------------------------------------FUNCT1
COMPONENT 0 FUNCTION a
VARIABLE 0 NAME a TYPE linearinterpolation NUMPOINTS 3 TIMES 0 1 99 VALUES 0 1 1
----------------------------------------------------------------------FUNCT2
COMPONENT 0 FUNCTION a
VARIABLE 0 NAME a TYPE linearinterpolation NUMPOINTS 4 TIMES 0 1 2 99 VALUES 0 0 1 1
----------------------------------------------------------------------FUNCT3
COMPONENT 0 FUNCTION a
VARIABLE 0 NAME a TYPE linearinterpolation NUMPOINTS 4 TIMES 0 2 3 99 VALUES 0 0 1 1
----------------------------------------------------------------------FUNCT4
COMPONENT 0 FUNCTION a
VARIABLE 0 NAME a TYPE linearinterpolation NUMPOINTS 2 TIMES 0 99 VALUES 1 1
----------------------------------------------------------RESULT DESCRIPTION
//STRUCTURE DIS structure NODE 17 QUANTITY dispx VALUE 3.28978533155475025e-02 TOLERANCE 1e-9
-------------------------------------------------------------PROBLEM SIZE
ELEMENTS                        5
NODES                           26
DIM                             3
MATERIALS                       9999
-------------------------------------------------------DESIGN DESCRIPTION
NDPOINT                         0
NDLINE                          0
NDSURF                          2
NDVOL                           0
------------------------------------------------------DSURF-NODE TOPOLOGY
NODE 1 DSURFACE 1
NODE 4 DSURFACE 1
NODE 2 DSURFACE 1
NODE 3 DSURFACE 1
NODE 7 DSURFACE 2
NODE 6 DSURFACE 2
NODE 8 DSURFACE 2
NODE 5 DSURFACE 2
--------------------------------------------------------------NODE COORDS
NODE 1 COORD 0.0 0.0 0.0
NODE 2 COORD 1.0 0.0 0.0
NODE 3 COORD 1.0 1.0 0.0
NODE 4 COORD 0.0 1.0 0.0
NODE 5 COORD 0.0 0.0 1.0
NODE 6 COORD 1.0 0.0 1.0
NODE 7 COORD 1.0 1.0 1.0
NODE 8 COORD 0.0 1.0 1.0
NODE 9 COORD 0.5 0.0 0.0
NODE 10 COORD 1.0 0.5 0.0
NODE 11 COORD 0.5 0.5 0.0
NODE 12 COORD 0.5 0.0 0.5
NODE 13 COORD 1.0 0.0 0.5
NODE 14 COORD 1.0 0.5 0.5
NODE 15 COORD 0.5 1.0 0.0
NODE 16 COORD 0.0 0.5 0.0
NODE 17 COORD 0.5 1.0 0.5
NODE 18 COORD 0.0 1.0 0.5
NODE 19 COORD 0.0 0.5 0.5
NODE 20 COORD 0.5 0.5 1.0
NODE 21 COORD 0.0 0.0 0.5
NODE 22 COORD 0.5 0.0 1.0
NODE 23 COORD 0.0 0.5 1.0
NODE 24 COORD 1.0 1.0 0.5
NODE 25 COORD 0.5 1.0 1.0
NODE 26 COORD 1.0 0.5 1.0
-------------------------------------------------------STRUCTURE ELEMENTS
1 SOLIDT10 TET10 1 2 3 6 9 10 11 12 13 14 MAT 1 KINEM nonlinear FIBER1 1.0 0.0 0.0 RAD 1.0 0.0 0.0 AXI 0.0 1.0 0.0 CIR 0.0 0.0 1.0
2 SOLIDT10 TET10 3 4 1 8 15 16 11 17 18 19 MAT 1 KINEM nonlinear FIBER1 1.0 0.0 0.0 RAD 1.0 0.0 0.0 AXI 0.0 1.0 0.0 CIR 0.0 0.0 1.0
3 SOLIDT10 TET10 1 6 8 5 12 20 19 21 22 23 MAT 1 KINEM nonlinear FIBER1 1.0 0.0 0.0 RAD 1.0 0.0 0.0 AXI 0.0 1.0 0.0 CIR 0.0 0.0 1.0
4 SOLIDT10 TET10 3 8 6 7 17 20 14 24 25 26 MAT 1 KINEM nonlinear FIBER1 1.0 0.0 0.0 RAD 1.0 0.0 0.0 AXI 0.0 1.0 0.0 CIR 0.0 0.0 1.0
5 SOLIDT10 TET10 1 3 8 6 11 17 19 12 14 20 MAT 1 KINEM nonlinear FIBER1 1.0 0.0 0.0 RAD 1.0 0.0 0.0 AXI 0.0 1.0 0.0 CIR 0.0 0.0 1.0
----------------------------------------------------------------------END
