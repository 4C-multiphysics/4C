//
// Maintainer: Amadeus Gebauer
//
-----------------------------------------------------------------------TITLE
Testcase for testing CoupAnisoExpo summand for different fiber prescriptions

The setup of the test-case are 2 cubes with different fiber prescriptions (FIBER1 vs. FIBER 2).
The cubes are fixed on the bottom surface (z=0). On the top surface (z=1), a
surface force is applied in x-, y- and z-direction.

Tests:
- CoupAnisoExpo summand for different fibers

Fibers:
- Element fiber notation (FIBER1 FIBER 2)

Elements:
- TET10
-----------------------------------------------------------------PROBLEM TYP
PROBLEMTYP                      Structure
----------------------------------------------------------STRUCTURAL DYNAMIC
INT_STRATEGY                    Standard
LINEAR_SOLVER                   1
DYNAMICTYP                      Statics
RESULTSEVRY                     1
RESTARTEVRY                     1
NLNSOL                          fullnewton                    
TIMESTEP                        0.5
NUMSTEP                         2
MAXTIME                         7                        
PREDICT                         ConstDisVelAcc                
NORM_DISP                       Abs
NORM_RESF                       Abs
NORMCOMBI_RESFDISP              And
TOLDISP                         1.0E-05
TOLRES                          1.0E-05
ADAPTCONV                       yes
ADAPTCONV_BETTER                0.01
MAXITER                         50
--------------------------------------------------------------------SOLVER 1
NAME                            Structure_Solver
SOLVER                          UMFPACK
-------------------------------------------------------------------MATERIALS
// Material for cube 1
MAT 1   MAT_ElastHyper   NUMMAT 2 MATIDS 10 11 DENS 0.1
MAT 10   ELAST_CoupNeoHooke YOUNG 10 NUE 0.25
MAT 11 ELAST_CoupAnisoExpo K1 100.0 K2 1.0 GAMMA 35.0 K1COMP 0.0 K2COMP 1.0 INIT 1 ADAPT_ANGLE No FIBER_ID 1 STR_TENS_ID 1000

// Material for cube 2
MAT 2   MAT_ElastHyper   NUMMAT 2 MATIDS 20 21 DENS 0.1
MAT 20   ELAST_CoupNeoHooke YOUNG 10 NUE 0.25
MAT 21 ELAST_CoupAnisoExpo K1 100.0 K2 1.0 GAMMA 35.0 K1COMP 0.0 K2COMP 1.0 INIT 1 ADAPT_ANGLE No FIBER_ID 2 STR_TENS_ID 1000

// Structural tensor strategy
MAT 1000 ELAST_StructuralTensor STRATEGY Standard
----------------------------------------------------------------------FUNCT1
COMPONENT 0 FUNCTION a
VARIABLE 0 NAME a TYPE linearinterpolation NUMPOINTS 2 TIMES 0 1 VALUES 0 1
----------------------------------------------------------------------FUNCT2
COMPONENT 0 FUNCTION a
VARIABLE 0 NAME a TYPE linearinterpolation NUMPOINTS 2 TIMES 0 1 VALUES 0 1
----------------------------------------------------------------------FUNCT3
COMPONENT 0 FUNCTION a
VARIABLE 0 NAME a TYPE linearinterpolation NUMPOINTS 2 TIMES 0 1 VALUES 0 1
----------------------------------------------------------RESULT DESCRIPTION
STRUCTURE DIS structure NODE 23 QUANTITY dispx VALUE -6.89074514369808228e-03 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 23 QUANTITY dispy VALUE -6.89074514368979291e-03 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 23 QUANTITY dispz VALUE 6.55558542621435814e-02 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 49 QUANTITY dispx VALUE -6.89074514369808228e-03 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 49 QUANTITY dispy VALUE -6.89074514368979291e-03 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 49 QUANTITY dispz VALUE 6.55558542621435814e-02 TOLERANCE 1e-9
----------------------------------------------DESIGN SURF DIRICH CONDITIONS
DSURF                           2
E 1 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 FUNCT 0 0 0 0 0 0
E 3 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 FUNCT 0 0 0 0 0 0
----------------------------------------------DESIGN SURF NEUMANN CONDITIONS
DSURF                           2
E 2 - NUMDOF 6 ONOFF 0 0 1 0 0 0 VAL 0.0 0.0 30.0 0.0 0.0 0.0 FUNCT 1 2 3 1 1 1 Live Mid
E 4 - NUMDOF 6 ONOFF 0 0 1 0 0 0 VAL 0.0 0.0 30.0 0.0 0.0 0.0 FUNCT 1 2 3 1 1 1 Live Mid
-------------------------------------------------------------PROBLEM SIZE
ELEMENTS                        20
NODES                           104
DIM                             3
MATERIALS                       9999
-------------------------------------------------------DESIGN DESCRIPTION
NDPOINT                         0
NDLINE                          0
NDSURF                          8
NDVOL                           0
------------------------------------------------------DSURF-NODE TOPOLOGY
NODE 9 DSURFACE 1
NODE 14 DSURFACE 1
NODE 4 DSURFACE 1
NODE 8 DSURFACE 1
NODE 3 DSURFACE 1
NODE 10 DSURFACE 1
NODE 15 DSURFACE 1
NODE 1 DSURFACE 1
NODE 2 DSURFACE 1
NODE 6 DSURFACE 2
NODE 23 DSURFACE 2
NODE 21 DSURFACE 2
NODE 25 DSURFACE 2
NODE 7 DSURFACE 2
NODE 22 DSURFACE 2
NODE 19 DSURFACE 2
NODE 26 DSURFACE 2
NODE 5 DSURFACE 2
NODE 30 DSURFACE 3
NODE 35 DSURFACE 3
NODE 29 DSURFACE 3
NODE 36 DSURFACE 3
NODE 28 DSURFACE 3
NODE 40 DSURFACE 3
NODE 41 DSURFACE 3
NODE 27 DSURFACE 3
NODE 34 DSURFACE 3
NODE 52 DSURFACE 4
NODE 32 DSURFACE 4
NODE 45 DSURFACE 4
NODE 48 DSURFACE 4
NODE 51 DSURFACE 4
NODE 31 DSURFACE 4
NODE 33 DSURFACE 4
NODE 49 DSURFACE 4
NODE 47 DSURFACE 4
--------------------------------------------------------------NODE COORDS
NODE 1 COORD 0.0 0.0 0.0
NODE 2 COORD 1.0 0.0 0.0
NODE 3 COORD 1.0 1.0 0.0
NODE 4 COORD 0.0 1.0 0.0
NODE 5 COORD 0.0 0.0 1.0
NODE 6 COORD 1.0 0.0 1.0
NODE 7 COORD 0.0 1.0 1.0
NODE 8 COORD 0.5 0.0 0.0
NODE 9 COORD 1.0 0.5 0.0
NODE 10 COORD 0.5 0.5 0.0
NODE 11 COORD 0.5 0.0 0.5
NODE 12 COORD 1.0 0.0 0.5
NODE 13 COORD 1.0 0.5 0.5
NODE 14 COORD 0.5 1.0 0.0
NODE 15 COORD 0.0 0.5 0.0
NODE 16 COORD 0.5 1.0 0.5
NODE 17 COORD 0.0 1.0 0.5
NODE 18 COORD 0.0 0.5 0.5
NODE 19 COORD 0.5 0.5 1.0
NODE 20 COORD 0.0 0.0 0.5
NODE 21 COORD 0.5 0.0 1.0
NODE 22 COORD 0.0 0.5 1.0
NODE 23 COORD 1.0 1.0 1.0
NODE 24 COORD 1.0 1.0 0.5
NODE 25 COORD 0.5 1.0 1.0
NODE 26 COORD 1.0 0.5 1.0
NODE 27 COORD 2.0 0.0 0.0
NODE 28 COORD 3.0 0.0 0.0
NODE 29 COORD 3.0 1.0 0.0
NODE 30 COORD 2.0 1.0 0.0
NODE 31 COORD 2.0 0.0 1.0
NODE 32 COORD 3.0 0.0 1.0
NODE 33 COORD 2.0 1.0 1.0
NODE 34 COORD 2.5 0.0 0.0
NODE 35 COORD 3.0 0.5 0.0
NODE 36 COORD 2.5 0.5 0.0
NODE 37 COORD 2.5 0.0 0.5
NODE 38 COORD 3.0 0.0 0.5
NODE 39 COORD 3.0 0.5 0.5
NODE 40 COORD 2.5 1.0 0.0
NODE 41 COORD 2.0 0.5 0.0
NODE 42 COORD 2.5 1.0 0.5
NODE 43 COORD 2.0 1.0 0.5
NODE 44 COORD 2.0 0.5 0.5
NODE 45 COORD 2.5 0.5 1.0
NODE 46 COORD 2.0 0.0 0.5
NODE 47 COORD 2.5 0.0 1.0
NODE 48 COORD 2.0 0.5 1.0
NODE 49 COORD 3.0 1.0 1.0
NODE 50 COORD 3.0 1.0 0.5
NODE 51 COORD 2.5 1.0 1.0
NODE 52 COORD 3.0 0.5 1.0
-------------------------------------------------------STRUCTURE ELEMENTS
1 SOLIDT10 TET10 1 2 3 6 8 9 10 11 12 13 MAT 1 KINEM nonlinear FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
2 SOLIDT10 TET10 3 4 1 7 14 15 10 16 17 18 MAT 1 KINEM nonlinear FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
3 SOLIDT10 TET10 1 6 7 5 11 19 18 20 21 22 MAT 1 KINEM nonlinear FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
4 SOLIDT10 TET10 3 7 6 23 16 19 13 24 25 26 MAT 1 KINEM nonlinear FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
5 SOLIDT10 TET10 1 3 7 6 10 16 18 11 13 19 MAT 1 KINEM nonlinear FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
6 SOLIDT10 TET10 27 28 29 32 34 35 36 37 38 39 MAT 2 KINEM nonlinear FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
7 SOLIDT10 TET10 29 30 27 33 40 41 36 42 43 44 MAT 2 KINEM nonlinear FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
8 SOLIDT10 TET10 27 32 33 31 37 45 44 46 47 48 MAT 2 KINEM nonlinear FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
9 SOLIDT10 TET10 29 33 32 49 42 45 39 50 51 52 MAT 2 KINEM nonlinear FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
10 SOLIDT10 TET10 27 29 33 32 36 42 44 37 39 45 MAT 2 KINEM nonlinear FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
-------------------------------------------------------------------------END
