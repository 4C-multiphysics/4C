//
// Maintainer: Amadeus Gebauer
//
-----------------------------------------------------------------------TITLE
Testcase for testing CoupAnisoExpo summand for different fiber prescriptions

The setup of the test-case are 4 cubes with different fiber prescriptions (nodal vs. element fibers,
FIBER1 vs. FIBER 2). The cubes are fixed on the bottom surface (z=0). On the top surface (z=1), a
surface force is applied in x-, y- and z-direction.

Tests:
- CoupAnisoExpo summand for different fibers

Fibers:
- Nodal fiber notation (FIBER1 FIBER 2)
- Element fiber notation (FIBER1 FIBER 2)

Elements:
- TET10
-----------------------------------------------------------------PROBLEM TYP
PROBLEMTYP                      Structure
----------------------------------------------------------STRUCTURAL DYNAMIC
INT_STRATEGY                    Standard
LINEAR_SOLVER                   1
DYNAMICTYP                      Statics
RESULTSEVRY                     1
RESTARTEVRY                     1
NLNSOL                          fullnewton                    
TIMESTEP                        0.5
NUMSTEP                         2
MAXTIME                         7                        
PREDICT                         ConstDisVelAcc                
NORM_DISP                       Abs
NORM_RESF                       Abs
NORMCOMBI_RESFDISP              And
TOLDISP                         1.0E-05
TOLRES                          1.0E-05
ADAPTCONV                       yes
ADAPTCONV_BETTER                0.01
MAXITER                         50
--------------------------------------------------------------------SOLVER 1
NAME                            Structure_Solver
SOLVER                          UMFPACK
-------------------------------------------------------------------MATERIALS
// Material for cube 1
MAT 1   MAT_ElastHyper   NUMMAT 2 MATIDS 10 11 DENS 0.1
MAT 10   ELAST_CoupNeoHooke YOUNG 10 NUE 0.25
MAT 11 ELAST_CoupAnisoExpo K1 100.0 K2 1.0 GAMMA 35.0 K1COMP 0.0 K2COMP 1.0 INIT 3 ADAPT_ANGLE No FIBER_ID 1 STR_TENS_ID 1000

// Material for cube 2
MAT 2   MAT_ElastHyper   NUMMAT 2 MATIDS 20 21 DENS 0.1
MAT 20   ELAST_CoupNeoHooke YOUNG 10 NUE 0.25
MAT 21 ELAST_CoupAnisoExpo K1 100.0 K2 1.0 GAMMA 35.0 K1COMP 0.0 K2COMP 1.0 INIT 3 ADAPT_ANGLE No FIBER_ID 2 STR_TENS_ID 1000

// Material for cube 3
MAT 3   MAT_ElastHyper   NUMMAT 2 MATIDS 30 31 DENS 0.1
MAT 30   ELAST_CoupNeoHooke YOUNG 10 NUE 0.25
MAT 31 ELAST_CoupAnisoExpo K1 100.0 K2 1.0 GAMMA 35.0 K1COMP 0.0 K2COMP 1.0 INIT 1 ADAPT_ANGLE No FIBER_ID 1 STR_TENS_ID 1000

// Material for cube 4
MAT 4   MAT_ElastHyper   NUMMAT 2 MATIDS 40 41 DENS 0.1
MAT 40   ELAST_CoupNeoHooke YOUNG 10 NUE 0.25
MAT 41 ELAST_CoupAnisoExpo K1 100.0 K2 1.0 GAMMA 35.0 K1COMP 0.0 K2COMP 1.0 INIT 1 ADAPT_ANGLE No FIBER_ID 2 STR_TENS_ID 1000

// Structural tensor strategy
MAT 1000 ELAST_StructuralTensor STRATEGY Standard
----------------------------------------------------------------------FUNCT1
COMPONENT 0 FUNCTION a
VARIABLE 0 NAME a TYPE linearinterpolation NUMPOINTS 2 TIMES 0 1 VALUES 0 1
----------------------------------------------------------------------FUNCT2
COMPONENT 0 FUNCTION a
VARIABLE 0 NAME a TYPE linearinterpolation NUMPOINTS 2 TIMES 0 1 VALUES 0 1
----------------------------------------------------------------------FUNCT3
COMPONENT 0 FUNCTION a
VARIABLE 0 NAME a TYPE linearinterpolation NUMPOINTS 2 TIMES 0 1 VALUES 0 1
----------------------------------------------------------RESULT DESCRIPTION
STRUCTURE DIS structure NODE 23 QUANTITY dispx VALUE -6.89074514369808228e-03 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 23 QUANTITY dispy VALUE -6.89074514368979291e-03 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 23 QUANTITY dispz VALUE 6.55558542621435814e-02 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 49 QUANTITY dispx VALUE -6.89074514369808228e-03 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 49 QUANTITY dispy VALUE -6.89074514368979291e-03 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 49 QUANTITY dispz VALUE 6.55558542621435814e-02 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 75 QUANTITY dispx VALUE -6.89074514369808228e-03 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 75 QUANTITY dispy VALUE -6.89074514368979291e-03 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 75 QUANTITY dispz VALUE 6.55558542621435814e-02 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 101 QUANTITY dispx VALUE -6.89074514369808228e-03 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 101 QUANTITY dispy VALUE -6.89074514368979291e-03 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 101 QUANTITY dispz VALUE 6.55558542621435814e-02 TOLERANCE 1e-9
----------------------------------------------DESIGN SURF DIRICH CONDITIONS
DSURF                           4
E 1 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 FUNCT 0 0 0 0 0 0
E 3 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 FUNCT 0 0 0 0 0 0
E 5 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 FUNCT 0 0 0 0 0 0
E 7 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 FUNCT 0 0 0 0 0 0
----------------------------------------------DESIGN SURF NEUMANN CONDITIONS
DSURF                           4
E 2 - NUMDOF 6 ONOFF 0 0 1 0 0 0 VAL 0.0 0.0 30.0 0.0 0.0 0.0 FUNCT 1 2 3 1 1 1 Live Mid
E 4 - NUMDOF 6 ONOFF 0 0 1 0 0 0 VAL 0.0 0.0 30.0 0.0 0.0 0.0 FUNCT 1 2 3 1 1 1 Live Mid
E 6 - NUMDOF 6 ONOFF 0 0 1 0 0 0 VAL 0.0 0.0 30.0 0.0 0.0 0.0 FUNCT 1 2 3 1 1 1 Live Mid
E 8 - NUMDOF 6 ONOFF 0 0 1 0 0 0 VAL 0.0 0.0 30.0 0.0 0.0 0.0 FUNCT 1 2 3 1 1 1 Live Mid
-------------------------------------------------------------PROBLEM SIZE
ELEMENTS                        20
NODES                           104
DIM                             3
MATERIALS                       9999
-------------------------------------------------------DESIGN DESCRIPTION
NDPOINT                         0
NDLINE                          0
NDSURF                          8
NDVOL                           0
------------------------------------------------------DSURF-NODE TOPOLOGY
NODE 9 DSURFACE 1
NODE 14 DSURFACE 1
NODE 4 DSURFACE 1
NODE 8 DSURFACE 1
NODE 3 DSURFACE 1
NODE 10 DSURFACE 1
NODE 15 DSURFACE 1
NODE 1 DSURFACE 1
NODE 2 DSURFACE 1
NODE 6 DSURFACE 2
NODE 23 DSURFACE 2
NODE 21 DSURFACE 2
NODE 25 DSURFACE 2
NODE 7 DSURFACE 2
NODE 22 DSURFACE 2
NODE 19 DSURFACE 2
NODE 26 DSURFACE 2
NODE 5 DSURFACE 2
NODE 30 DSURFACE 3
NODE 35 DSURFACE 3
NODE 29 DSURFACE 3
NODE 36 DSURFACE 3
NODE 28 DSURFACE 3
NODE 40 DSURFACE 3
NODE 41 DSURFACE 3
NODE 27 DSURFACE 3
NODE 34 DSURFACE 3
NODE 52 DSURFACE 4
NODE 32 DSURFACE 4
NODE 45 DSURFACE 4
NODE 48 DSURFACE 4
NODE 51 DSURFACE 4
NODE 31 DSURFACE 4
NODE 33 DSURFACE 4
NODE 49 DSURFACE 4
NODE 47 DSURFACE 4
NODE 55 DSURFACE 5
NODE 56 DSURFACE 5
NODE 67 DSURFACE 5
NODE 54 DSURFACE 5
NODE 66 DSURFACE 5
NODE 53 DSURFACE 5
NODE 60 DSURFACE 5
NODE 62 DSURFACE 5
NODE 61 DSURFACE 5
NODE 78 DSURFACE 6
NODE 58 DSURFACE 6
NODE 73 DSURFACE 6
NODE 59 DSURFACE 6
NODE 71 DSURFACE 6
NODE 77 DSURFACE 6
NODE 75 DSURFACE 6
NODE 74 DSURFACE 6
NODE 57 DSURFACE 6
NODE 87 DSURFACE 7
NODE 88 DSURFACE 7
NODE 81 DSURFACE 7
NODE 92 DSURFACE 7
NODE 82 DSURFACE 7
NODE 86 DSURFACE 7
NODE 93 DSURFACE 7
NODE 79 DSURFACE 7
NODE 80 DSURFACE 7
NODE 84 DSURFACE 8
NODE 83 DSURFACE 8
NODE 85 DSURFACE 8
NODE 104 DSURFACE 8
NODE 103 DSURFACE 8
NODE 100 DSURFACE 8
NODE 97 DSURFACE 8
NODE 99 DSURFACE 8
NODE 101 DSURFACE 8
--------------------------------------------------------------NODE COORDS
FNODE 1 COORD 0.0 0.0 0.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 2 COORD 1.0 0.0 0.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 3 COORD 1.0 1.0 0.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 4 COORD 0.0 1.0 0.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 5 COORD 0.0 0.0 1.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 6 COORD 1.0 0.0 1.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 7 COORD 0.0 1.0 1.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 8 COORD 0.5 0.0 0.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 9 COORD 1.0 0.5 0.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 10 COORD 0.5 0.5 0.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 11 COORD 0.5 0.0 0.5 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 12 COORD 1.0 0.0 0.5 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 13 COORD 1.0 0.5 0.5 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 14 COORD 0.5 1.0 0.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 15 COORD 0.0 0.5 0.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 16 COORD 0.5 1.0 0.5 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 17 COORD 0.0 1.0 0.5 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 18 COORD 0.0 0.5 0.5 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 19 COORD 0.5 0.5 1.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 20 COORD 0.0 0.0 0.5 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 21 COORD 0.5 0.0 1.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 22 COORD 0.0 0.5 1.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 23 COORD 1.0 1.0 1.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 24 COORD 1.0 1.0 0.5 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 25 COORD 0.5 1.0 1.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 26 COORD 1.0 0.5 1.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 27 COORD 2.0 0.0 0.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 28 COORD 3.0 0.0 0.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 29 COORD 3.0 1.0 0.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 30 COORD 2.0 1.0 0.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 31 COORD 2.0 0.0 1.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 32 COORD 3.0 0.0 1.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 33 COORD 2.0 1.0 1.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 34 COORD 2.5 0.0 0.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 35 COORD 3.0 0.5 0.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 36 COORD 2.5 0.5 0.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 37 COORD 2.5 0.0 0.5 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 38 COORD 3.0 0.0 0.5 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 39 COORD 3.0 0.5 0.5 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 40 COORD 2.5 1.0 0.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 41 COORD 2.0 0.5 0.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 42 COORD 2.5 1.0 0.5 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 43 COORD 2.0 1.0 0.5 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 44 COORD 2.0 0.5 0.5 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 45 COORD 2.5 0.5 1.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 46 COORD 2.0 0.0 0.5 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 47 COORD 2.5 0.0 1.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 48 COORD 2.0 0.5 1.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 49 COORD 3.0 1.0 1.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 50 COORD 3.0 1.0 0.5 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 51 COORD 2.5 1.0 1.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
FNODE 52 COORD 3.0 0.5 1.0 FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
NODE 53 COORD 4.0 0.0 0.0
NODE 54 COORD 5.0 0.0 0.0
NODE 55 COORD 5.0 1.0 0.0
NODE 56 COORD 4.0 1.0 0.0
NODE 57 COORD 4.0 0.0 1.0
NODE 58 COORD 5.0 0.0 1.0
NODE 59 COORD 4.0 1.0 1.0
NODE 60 COORD 4.5 0.0 0.0
NODE 61 COORD 5.0 0.5 0.0
NODE 62 COORD 4.5 0.5 0.0
NODE 63 COORD 4.5 0.0 0.5
NODE 64 COORD 5.0 0.0 0.5
NODE 65 COORD 5.0 0.5 0.5
NODE 66 COORD 4.5 1.0 0.0
NODE 67 COORD 4.0 0.5 0.0
NODE 68 COORD 4.5 1.0 0.5
NODE 69 COORD 4.0 1.0 0.5
NODE 70 COORD 4.0 0.5 0.5
NODE 71 COORD 4.5 0.5 1.0
NODE 72 COORD 4.0 0.0 0.5
NODE 73 COORD 4.5 0.0 1.0
NODE 74 COORD 4.0 0.5 1.0
NODE 75 COORD 5.0 1.0 1.0
NODE 76 COORD 5.0 1.0 0.5
NODE 77 COORD 4.5 1.0 1.0
NODE 78 COORD 5.0 0.5 1.0
NODE 79 COORD 6.0 0.0 0.0
NODE 80 COORD 7.0 0.0 0.0
NODE 81 COORD 7.0 1.0 0.0
NODE 82 COORD 6.0 1.0 0.0
NODE 83 COORD 6.0 0.0 1.0
NODE 84 COORD 7.0 0.0 1.0
NODE 85 COORD 6.0 1.0 1.0
NODE 86 COORD 6.5 0.0 0.0
NODE 87 COORD 7.0 0.5 0.0
NODE 88 COORD 6.5 0.5 0.0
NODE 89 COORD 6.5 0.0 0.5
NODE 90 COORD 7.0 0.0 0.5
NODE 91 COORD 7.0 0.5 0.5
NODE 92 COORD 6.5 1.0 0.0
NODE 93 COORD 6.0 0.5 0.0
NODE 94 COORD 6.5 1.0 0.5
NODE 95 COORD 6.0 1.0 0.5
NODE 96 COORD 6.0 0.5 0.5
NODE 97 COORD 6.5 0.5 1.0
NODE 98 COORD 6.0 0.0 0.5
NODE 99 COORD 6.5 0.0 1.0
NODE 100 COORD 6.0 0.5 1.0
NODE 101 COORD 7.0 1.0 1.0
NODE 102 COORD 7.0 1.0 0.5
NODE 103 COORD 6.5 1.0 1.0
NODE 104 COORD 7.0 0.5 1.0
-------------------------------------------------------STRUCTURE ELEMENTS
1 SOLIDT10 TET10 1 2 3 6 8 9 10 11 12 13 MAT 1 KINEM nonlinear
2 SOLIDT10 TET10 3 4 1 7 14 15 10 16 17 18 MAT 1 KINEM nonlinear
3 SOLIDT10 TET10 1 6 7 5 11 19 18 20 21 22 MAT 1 KINEM nonlinear
4 SOLIDT10 TET10 3 7 6 23 16 19 13 24 25 26 MAT 1 KINEM nonlinear
5 SOLIDT10 TET10 1 3 7 6 10 16 18 11 13 19 MAT 1 KINEM nonlinear
6 SOLIDT10 TET10 27 28 29 32 34 35 36 37 38 39 MAT 2 KINEM nonlinear
7 SOLIDT10 TET10 29 30 27 33 40 41 36 42 43 44 MAT 2 KINEM nonlinear
8 SOLIDT10 TET10 27 32 33 31 37 45 44 46 47 48 MAT 2 KINEM nonlinear
9 SOLIDT10 TET10 29 33 32 49 42 45 39 50 51 52 MAT 2 KINEM nonlinear
10 SOLIDT10 TET10 27 29 33 32 36 42 44 37 39 45 MAT 2 KINEM nonlinear
11 SOLIDT10 TET10 53 54 55 58 60 61 62 63 64 65 MAT 3 KINEM nonlinear FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
12 SOLIDT10 TET10 55 56 53 59 66 67 62 68 69 70 MAT 3 KINEM nonlinear FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
13 SOLIDT10 TET10 53 58 59 57 63 71 70 72 73 74 MAT 3 KINEM nonlinear FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
14 SOLIDT10 TET10 55 59 58 75 68 71 65 76 77 78 MAT 3 KINEM nonlinear FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
15 SOLIDT10 TET10 53 55 59 58 62 68 70 63 65 71 MAT 3 KINEM nonlinear FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
16 SOLIDT10 TET10 79 80 81 84 86 87 88 89 90 91 MAT 4 KINEM nonlinear FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
17 SOLIDT10 TET10 81 82 79 85 92 93 88 94 95 96 MAT 4 KINEM nonlinear FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
18 SOLIDT10 TET10 79 84 85 83 89 97 96 98 99 100 MAT 4 KINEM nonlinear FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
19 SOLIDT10 TET10 81 85 84 101 94 97 91 102 103 104 MAT 4 KINEM nonlinear FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
20 SOLIDT10 TET10 79 81 85 84 88 94 96 89 91 97 MAT 4 KINEM nonlinear FIBER1 0.0 1.0 0.0 FIBER2 0.0 0.0 1.0
-------------------------------------------------------------------------END
