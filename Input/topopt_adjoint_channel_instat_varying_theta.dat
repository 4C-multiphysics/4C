//
// Maintainer: Martin Winklmaier
// winklmaier@lnm.mw.tum.de
// http://www.lnm.mw.tum.de
// 089 - 289-15241
//
// necessary defines: CCADISCRET D_FLUID3 QHULL BINIO
//
==================================================================
General Data File BACI
==================================================================
-----------------------------------------------------------------------TITLE
- instationary adjoint fluid example in the topopt frame with a time-independent solution
- academical, two-dimensional test case with a duct
- spatial constant, temporal constant fluid velocity field:
        o       u_1 = 1
        o       u_2 = 2
- spatial linear, temporal constant fluid pressure field:
                p = -5*x - 10*y
- spatial linear, temporal linear adjoint velocity field:
        o       v_1 = x - t
        o       v_2 = 2*t - y
- spatial linear, temporal linear adjoint pressure field:
                q = -5*t*x + 10*t*y
- all right hand side terms set adequate (fluid bodyforce, DBC, NBC, adjoint bodyforce contforce, DBC, NBC)
- all constants different and unequal 1
- theta for all terms 0.5
------------------------------------------------------PROBLEM SIZE
//ELEMENTS    10
//NODES       45
DIM           2
-------------------------------------------------------PROBLEM TYP
PROBLEMTYP   Fluid_Top_Opt
NUMFIELD     1
RESTART      0
----------------------------------------------------------------IO
OUTPUT_OUT             No
OUTPUT_GID             No
OUTPUT_BIN             Yes
STRUCT_DISP            No
STRUCT_STRESS          No
STRUCT_STRAIN          No
STRUCT_SM_DISP         No
FLUID_SOL              Yes
FLUID_STRESS           No
FLUID_VIS              No
ALE_DISP               No
THERM_TEMPERATURE      No
THERM_HEATFLUX         No
FILESTEPS              1000
-------------------------------------------------------TOPOLOGY OPTIMIZATION CONTROL
CONV_CHECK_TYPE                 Residuum
INCTOL                          1e-6
MAXTIME                         0.5
NUMSTEP                         5
RESTARTEVRY                     100000
RESTOL                          1e-6
RESTART_ACTION                  Fluid_Time_Step
TIMESTEP                        0.1
UPRES                           1
-------------------------------------------------------TOPOLOGY OPTIMIZATION CONTROL/TOPOLOGY OPTIMIZER
MAX_ITER                        1
MATID                           2
INITIALFIELD                    field_by_function
INITFUNCNO                      2
-------------------------------------------------------TOPOLOGY OPTIMIZATION CONTROL/TOPOLOGY ADJOINT FLUID
INITIALFIELD                    field_by_function
TESTCASE                        test_instat_varying_theta
INITFUNCNO                      3
THETA_DIV                       0.8
THETA_PRES                      0.6
------------------------------------------------------FLUID DYNAMIC
LINEAR_SOLVER                   1
ADAPTCONV                       yes
ADAPTCONV_BETTER                0.1
CONVCHECK                       L_2_norm
CONVFORM                        convective //conservative
CONVTOL                         1e-10
INITIALFIELD                    field_by_function
ITEMAX                          5
NONLINITER                      Newton //fixed_point_like
PHYSICAL_TYPE                   Topology_optimization
PREDICTOR                       steady_state_predictor
STARTFUNCNO                     1
STEADYSTEP                      -1
STEADYTOL                       1e-6
THETA                           0.6
TIMEINTEGR                      One_Step_Theta//Stationary//
---------------------------------------FLUID DYNAMIC/STABILIZATION
CROSS-STRESS                    no_cross
CSTAB                           cstab_qs
DEFINITION_TAU                  Taylor_Hughes_Zarins_Whiting_Jansen //Franca_Barrenechea_Valentin_Frey_Wall
EVALUATION_MAT                  integration_point
EVALUATION_TAU                  integration_point
PSPG                            yes_pspg
REYNOLDS-STRESS                 no_reynolds
STABTYPE                        residual_based
SUPG                            yes_supg
TDS                             quasistatic
TRANSIENT                       no_transient
VSTAB                           no_vstab
--------------------------------------------------------------------SOLVER 1
NAME                            Fluid_Solver_for_Top_Opt
SOLVER                          UMFPACK
-----------------------------------------------CLONING MATERIAL MAP
SRC_FIELD fluid SRC_MAT 1 TAR_FIELD scatra TAR_MAT 2
---------------------------------------------------------MATERIALS
MAT     1       MAT_fluid  DYNVISCOSITY 2.0 DENSITY 3.0
MAT     2       MAT_opti        MINPORO 0       MAXPORO 5       SMEARFAC        1
------------------------------------------------------------CURVE1
------------------------------------------------------------CURVE2
------------------------------------------------------------CURVE3
------------------------------------------------------------FUNCT1 // initial flow field
FUNCT1 COMPONENT 0 EXPR 0 0.0 0 FUNCTION 1
FUNCT1 COMPONENT 1 EXPR 0 0.0 0 FUNCTION 2
FUNCT1 COMPONENT 2 EXPR 0 0.0 0 FUNCTION -5*x-10*y
------------------------------------------------------------FUNCT2 // initial density field
FUNCT2 EXPR 0 0.0 0 FUNCTION 0.0 // 1=fluid,0=no fluid
------------------------------------------------------------FUNCT3 // initial adjoint field
FUNCT3 COMPONENT 0 EXPR 0 0.0 0 FUNCTION x-t
FUNCT3 COMPONENT 1 EXPR 0 0.0 0 FUNCTION 2*t-y
FUNCT3 COMPONENT 2 EXPR 0 0.0 0 FUNCTION -5*t*x+10*t*y
------------------------------------------------------------FUNCT4 // x-component of fluid inflow profile
FUNCT4 EXPR 0 0.0 0 FUNCTION 1
------------------------------------------------------------FUNCT5 // y-component of fluid inflow profile
FUNCT5 EXPR 0 0.0 0 FUNCTION 2
------------------------------------------------------------FUNCT6 // NBC in x-direction
FUNCT6 EXPR 0 0.0 0 FUNCTION 5*x+10*y
------------------------------------------------------------FUNCT7 // NBC in y-direction
FUNCT7 EXPR 0 0.0 0 FUNCTION 0
------------------------------------------------DESIGN DESCRIPTION
NDPOINT 0
NDLINE  3
NDSURF  1
NDVOL   0
------------------------------------DESIGN SURF NEUMANN CONDITIONS
DSURF  1
// volume force
E 1 - none 1 1 0 0 0 0  0.0 0.0 0.0 0.0 0.0 0.0  Live Mid 0 0 0 0 0 0
------------------------------------DESIGN LINE NEUMANN CONDITIONS
DLINE  1
// outflow
E 3 - none 1 1 0 0 0 0  1.0 1.0 0.0 0.0 0.0 0.0  Live Mid 6 7 0 0 0 0
-------------------------------------DESIGN LINE DIRICH CONDITIONS
DLINE  2
// inflow
E 1 - 3 1 1 0 1.0 1.0 0.0 none none none 4 5 0 
// sides
E 2 - 3 1 1 0 1.0 1.0 0.0 none none none 4 5 0 
----------------------------------------------------------RESULT DESCRIPTION
FLUID DIS 1 NODE 4 POSITION pressure NAME pressure VALUE -1.0 TOLERANCE 1.0e-12
FLUID DIS 1 NODE 7 POSITION pressure NAME pressure VALUE -1.5 TOLERANCE 1.0e-12
FLUID DIS 1 NODE 12 POSITION velx NAME velx VALUE 1.0 TOLERANCE 1.0e-15
FLUID DIS 1 NODE 12 POSITION vely NAME vely VALUE 2.0 TOLERANCE 1.0e-15
FLUID DIS 1 NODE 12 POSITION pressure NAME pressure VALUE -3.5 TOLERANCE 1.0e-12

ADJOINT DIS 1 NODE 4 POSITION velx NAME velx VALUE 0.0 TOLERANCE 1.0e-15
ADJOINT DIS 1 NODE 4 POSITION vely NAME vely VALUE -0.1 TOLERANCE 1.0e-15
ADJOINT DIS 1 NODE 4 POSITION pressure NAME pressure VALUE 0.0 TOLERANCE 1.0e-11
ADJOINT DIS 1 NODE 7 POSITION velx NAME velx VALUE 0.3 TOLERANCE 1.0e-15
ADJOINT DIS 1 NODE 7 POSITION vely NAME vely VALUE 0.0 TOLERANCE 1.0e-15
ADJOINT DIS 1 NODE 7 POSITION pressure NAME pressure VALUE 0.0 TOLERANCE 1.0e-11
ADJOINT DIS 1 NODE 12 POSITION velx NAME velx VALUE 0.5 TOLERANCE 1.0e-15
ADJOINT DIS 1 NODE 12 POSITION vely NAME vely VALUE -0.1 TOLERANCE 1.0e-12
ADJOINT DIS 1 NODE 12 POSITION pressure NAME pressure VALUE 0.0 TOLERANCE 1.0e-11
-----------------------------------------------DNODE-NODE TOPOLOGY
-----------------------------------------------DLINE-NODE TOPOLOGY
NODE    1 DLINE 1
NODE    4 DLINE 1
NODE    14 DLINE 1
NODE    1 DLINE 2
NODE    2 DLINE 2
NODE    5 DLINE 2
NODE    7 DLINE 2
NODE    9 DLINE 2
NODE    11 DLINE 2
NODE    13 DLINE 2
NODE    14 DLINE 2
NODE    15 DLINE 2
NODE    16 DLINE 2
NODE    17 DLINE 2
NODE    18 DLINE 2
NODE    11 DLINE 3
NODE    12 DLINE 3
NODE    18 DLINE 3
-----------------------------------------------DSURF-NODE TOPOLOGY
NODE    1 DSURF 1
NODE    2 DSURF 1
NODE    3 DSURF 1
NODE    4 DSURF 1
NODE    5 DSURF 1
NODE    6 DSURF 1
NODE    7 DSURF 1
NODE    8 DSURF 1
NODE    9 DSURF 1
NODE    10 DSURF 1
NODE    11 DSURF 1
NODE    12 DSURF 1
NODE    13 DSURF 1
NODE    14 DSURF 1
NODE    15 DSURF 1
NODE    16 DSURF 1
NODE    17 DSURF 1
NODE    18 DSURF 1
------------------------------------------------DVOL-NODE TOPOLOGY
-------------------------------------------------------NODE COORDS
NODE 1  	COORD	0.0000000000000000e+00	0.0000000000000000e+00	0.0000000000000000e+00	
NODE 2  	COORD	1.0000000000000001e-01	0.0000000000000000e+00	0.0000000000000000e+00	
NODE 3  	COORD	9.9999999999999992e-02	1.0000000000000001e-01	0.0000000000000000e+00	
NODE 4  	COORD	0.0000000000000000e+00	1.0000000000000001e-01	0.0000000000000000e+00	
NODE 5  	COORD	2.0000000000000001e-01	0.0000000000000000e+00	0.0000000000000000e+00	
NODE 6  	COORD	1.9999999999999998e-01	1.0000000000000001e-01	0.0000000000000000e+00	
NODE 7  	COORD	3.0000000000000004e-01	0.0000000000000000e+00	0.0000000000000000e+00	
NODE 8  	COORD	3.0000000000000004e-01	1.0000000000000001e-01	0.0000000000000000e+00	
NODE 9  	COORD	4.0000000000000002e-01	0.0000000000000000e+00	0.0000000000000000e+00	
NODE 10  	COORD	4.0000000000000002e-01	1.0000000000000001e-01	0.0000000000000000e+00	
NODE 11  	COORD	5.0000000000000000e-01	0.0000000000000000e+00	0.0000000000000000e+00	
NODE 12  	COORD	5.0000000000000000e-01	1.0000000000000001e-01	0.0000000000000000e+00	
NODE 13  	COORD	9.9999999999999978e-02	2.0000000000000001e-01	0.0000000000000000e+00	
NODE 14  	COORD	0.0000000000000000e+00	2.0000000000000001e-01	0.0000000000000000e+00	
NODE 15  	COORD	1.9999999999999996e-01	2.0000000000000001e-01	0.0000000000000000e+00	
NODE 16  	COORD	2.9999999999999999e-01	2.0000000000000001e-01	0.0000000000000000e+00	
NODE 17  	COORD	4.0000000000000002e-01	2.0000000000000001e-01	0.0000000000000000e+00	
NODE 18  	COORD	5.0000000000000000e-01	2.0000000000000001e-01	0.0000000000000000e+00	
------------------------------------------------STRUCTURE ELEMENTS
----------------------------------------------------FLUID ELEMENTS
   1 FLUID2 QUAD4  1 2 3 4    MAT 1 NA Euler GP 2 2
   2 FLUID2 QUAD4  2 5 6 3    MAT 1 NA Euler GP 2 2
   3 FLUID2 QUAD4  5 7 8 6    MAT 1 NA Euler GP 2 2
   4 FLUID2 QUAD4  7 9 10 8    MAT 1 NA Euler GP 2 2
   5 FLUID2 QUAD4  9 11 12 10    MAT 1 NA Euler GP 2 2
   6 FLUID2 QUAD4  4 3 13 14    MAT 1 NA Euler GP 2 2
   7 FLUID2 QUAD4  3 6 15 13    MAT 1 NA Euler GP 2 2
   8 FLUID2 QUAD4  6 8 16 15    MAT 1 NA Euler GP 2 2
   9 FLUID2 QUAD4  8 10 17 16    MAT 1 NA Euler GP 2 2
   10 FLUID2 QUAD4  10 12 18 17    MAT 1 NA Euler GP 2 2
------------------------------------------------------ALE ELEMENTS
------------------------------------------------TRANSPORT ELEMENTS
---------------------------------------------------THERMO ELEMENTS
---------------------------------------------------------------END
// END
