//
// Maintainer: Karl-Robert Wichmann
//
// Test of the direct specification of geometry
// Based on: Test of Edge-based pressure stabilization (pEOS) for hex8 elements
//
==================================================================
                  General Data File BACI
==================================================================
-------------------------------------------------------------TITLE
created by pre_exodus
------------------------------------------------------PROBLEM SIZE
//ELEMENTS    1001
//NODES       1339
DIM           3
-----------------------------------------------------------------PROBLEM TYP
PROBLEMTYP                      Fluid
RESTART                         0
--------------------------------------------------------------DISCRETISATION
NUMFLUIDDIS                     1
NUMSTRUCDIS                     1
NUMALEDIS                       1
NUMTHERMDIS                     1
--------------------------------------------------------------------------IO
OUTPUT_GID                      No
OUTPUT_BIN                      Yes
STRUCT_STRESS                   No
STRUCT_STRAIN                   No
FLUID_SOL                       Yes
FLUID_STRESS                    No
FLUID_VIS                       No
THERM_TEMPERATURE               No
THERM_HEATFLUX                  No
FILESTEPS                       1000
-----------------------------------------------------FLUID DYNAMIC
INITIALFIELD     zero_field //field_by_function
STARTFUNCNO      2
TIMEINTEGR       Stationary
NONLINITER       fixed_point_like
PHYSICAL_TYPE    Stokes //Incompressible //Stokes //Stokes
ITEMAX           10
CONVCHECK        L_2_norm
CONVTOL          1.0E-13
UPRES            1
RESTARTEVRY      5
NUMSTEP          1//2
NUMSTASTEPS      0
MAXTIME          1000.0
TIMESTEP         1.0//0.1
THETA            1.0 //0.5 //0.67
START_THETA      1.0
ALPHA_F          1.00
ALPHA_M          1.00
LIFTDRAG         no
ADAPTCONV        Yes
ADAPTCONV_BETTER 0.1
SIMPLER          No
LINEAR_SOLVER    1
GMSH_OUTPUT      no
NONLINEARBC      no
INFNORMSCALING   no
GEOMETRY         box
-------------------------------------------------FLUID DYNAMIC/RESIDUAL-BASED STABILIZATION
STABTYPE                        edge_based //residual_based
DEFINITION_TAU                  Hughes_Franca_Balestra_wo_dt // Taylor_Hughes_Zarins_Whiting_Jansen_wo_dt //Franca_Barrenechea_Valentin_Frey_Wall_wo_dt //Barrenechea_Franca_Valentin_Wall
TDS                             quasistatic
TRANSIENT                       no_transient
PSPG                            no //yes //yes //yes//yes
SUPG                            no
VSTAB                           no_vstab
GRAD_DIV                        no
CROSS-STRESS                    no_cross
REYNOLDS-STRESS                 no_reynolds
--------------------------------------FLUID DYNAMIC/EDGE-BASED STABILIZATION
EOS_PRES                        std_eos //xfem_gp
EOS_CONV_STREAM                 none //xfem_gp // none, std_eos, xfem_gp
EOS_CONV_CROSS                  none // none, std_eos, xfem_gp
EOS_DIV                         none //, vel_jump_std_eos, vel_jump_xfem_gp, div_jump_std_eos, div_jump_xfem_gp
EOS_DEFINITION_TAU              Burman_Hansbo_DAngelo_Zunino_wo_dt //Burman_Fernandez_Hansbo_
EOS_H_DEFINITION                EOS_he_surf_with_max_diameter// EOS_he_max_dist_to_opp_surf //EOS_he_surf_with_max_diameter // EOS_he_surf_with_max_diameter
--------------------------------------------------------------------SOLVER 1
NAME                            Fluid_Solver
SOLVER                          Aztec_MSR                       // vm3 Aztec_MSR SPOOLES_nonsym Superlu Colsol UMFPACK Amesos_KLU_sym Amesos_KLU_nonsym LAPACK_sym LAPACK_nonsym
AZOUTPUT                        50                              // output every so often, 0 no output
AZSOLVE                         GMRES                           // CG GMRES CGS BiCGSTAB LU TFQMR
ML_PRINT                        5
AZPREC                          MLFLUID2 //MLFLUID2                        // none ML MLFLUID MLFLUID2 LU ILU ILUT LU ICC Jacobi SymmGaussSeidel Least_Squares Neumann
AZREUSE                         0                               // how often to recompute some preconditioners
AZDROP                          0.0                             // drop tolerance for ILUT
AZOMEGA                         1.0       // unused
AZGRAPH                         1         // unused
AZPOLY                          5         // polynomial order for Neumann
AZSCAL                          none      // none sym infnorm scaling of the system
IFPACKFILL                      1.0                             // fill-in for ILUT
IFPACKGFILL                     0                               // (3 for edgebased stabilization pattern) graph fill for ILU
AZTOL                           1.0E-12                        // tolerance in unscaled residual
AZCONV                          AZ_r0                           // scale residual for convergence check by AZ_r0 AZ_rhs AZ_Anorm AZ_sol AZ_weighted AZ_expected_values AZ_noscaled AZTECOO_conv_test AZ_inf_noscaled
AZITER                          1000                            // max iterations
AZSUB                           30                            // size of krylov space for gmres
ML_MAXCOARSESIZE                2500 // ML stop coarsening when coarse ndof smaller then this (1: each level has to be used)
ML_MAXLEVEL                     3                              // ML max number of levels
ML_COARSEN                      UC                              // UC MIS METIS VBMETIS
ML_AGG_SIZE                     27                              // objective size of an aggregate with METIS/VBMETIS, 2D: 9, 3D: 27
ML_PROLONG_SMO                  0.0                             // damping factor for prolongator smoother (usually 0.0 or 1.33)
ML_PROLONG_THRES                0.0                            // threshold for prolongator smoother/aggregation
ML_SMOOTHERFINE                 SGS //ILU                             // SGS Jacobi Chebychev MLS ILU KLU
ML_SMOOTHERMED                  SGS //ILU                             // SGS Jacobi Chebychev MLS ILU KLU
ML_SMOOTHERCOARSE               Umfpack                         // SGS Jacobi Chebychev MLS KLU Superlu
ML_SMOTIMES                     3 3 1 // no. smoothing steps or polynomial order on each level (at least ML_MAXLEVEL numbers)
ML_DAMPFINE                     0.66//66 //0.66                            // damping fine grid
ML_DAMPMED                      0.66 //66                             // damping med grids
ML_DAMPCOARSE                   1.0                             // damping coarse grid
---------------------------------------------------------MATERIALS
MAT       1 MAT_fluid  DYNVISCOSITY 1.0 DENSITY 1.0 GAMMA 1.0
MAT       2 MAT_Struct_StVenantKirchhoff  YOUNG 1.0 NUE 0.0 DENS 1.0 THEXPANS 0.0
------------------------------------------------------------FUNCT1
FUNCT1 COMPONENT 0 EXPR 0 0.0 0 FUNCTION 20.0*(y*y-0.25)*(z*z-0.25) //velx
FUNCT1 COMPONENT 1 EXPR 0 0.0 0 FUNCTION 0.0
FUNCT1 COMPONENT 2 EXPR 0 0.0 0 FUNCTION 0.0
FUNCT1 COMPONENT 3 EXPR 0 0.0 0 FUNCTION 0.0 //pressure
------------------------------------------------------------FUNCT2 // initial solid velocity
FUNCT2 COMPONENT 0 EXPR 0 0.0 0 FUNCTION 5.0+3.0*y+2.0*z //1.25-5.0*y*y //0.0
FUNCT2 COMPONENT 1 EXPR 0 0.0 0 FUNCTION 0.0
FUNCT2 COMPONENT 2 EXPR 0 0.0 0 FUNCTION 0.0
FUNCT2 COMPONENT 3 EXPR 0 0.0 0 FUNCTION x //(-10.0*0.1*x) //+5.0*z // 0.0 // pressure
------------------------------------------------------------FUNCT3
FUNCT3 COMPONENT 0 EXPR 0 0.0 0 FUNCTION 10.0 //1.25-5.0*y*y //0.0
FUNCT3 COMPONENT 1 EXPR 0 0.0 0 FUNCTION 10.0 //0.0
FUNCT3 COMPONENT 2 EXPR 0 0.0 0 FUNCTION 10.0 //0.0
FUNCT3 COMPONENT 3 EXPR 0 0.0 0 FUNCTION 0.0 //(-10.0*0.1*x) //+5.0*z // 0.0 // pressure
------------------------------------------------------------FUNCT4
FUNCT4 EXPR 0 0 0 FUNCTION 20.0*2.0*y*(z*z-0.25)*1.0
------------------------------------------------------------FUNCT5
FUNCT5 EXPR 0 0 0 FUNCTION 20.0*2.0*z*(y*y-0.25)*1.0
------------------------------------------------------------FUNCT6
----------------------------------------------------------RESULT DESCRIPTION
FLUID DIS fluid NODE 981 QUANTITY velx VALUE 3.00031798912431591e-01 TOLERANCE 1e-12
FLUID DIS fluid NODE 981 QUANTITY vely VALUE -7.19530748121974782e-03 TOLERANCE 1e-12
FLUID DIS fluid NODE 981 QUANTITY velz VALUE 1.13516545920796692e-02 TOLERANCE 1e-12
FLUID DIS fluid NODE 981 QUANTITY pressure VALUE 1.05415220567382395e+01 TOLERANCE 1e-12
FLUID DIS fluid NODE 696 QUANTITY velx VALUE 7.93199863363006741e-01 TOLERANCE 1e-12
FLUID DIS fluid NODE 696 QUANTITY vely VALUE 1.39125121461597945e-02 TOLERANCE 1e-12
FLUID DIS fluid NODE 696 QUANTITY velz VALUE 1.21051518152786282e-16 TOLERANCE 1e-12
FLUID DIS fluid NODE 696 QUANTITY pressure VALUE 9.58866700494419888e+00 TOLERANCE 1e-12
------------------------------------------------DESIGN DESCRIPTION
NDPOINT 2
NDLINE  14
NDSURF  6
NDVOL   2
------------------------------------DESIGN SURF NEUMANN CONDITIONS
DSURF  1
// surface_outflow
E 6 - none 1 1 1 0 0 0 +3.0 1.0 1.0 0.0 0.0 0.0 Live Mid 0 4 5 0 0 0
------------------------------------DESIGN POINT DIRICH CONDITIONS
DPOINT 2
// inflow_points
E 1 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// outflow_points
E 2 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
-------------------------------------DESIGN LINE DIRICH CONDITIONS
DLINE  14
// line_inflow_top
E 1 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// line_inflow_front
E 2 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// line_inflow_bottom
E 3 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// line_inflow_back
E 4 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// inflow_lines
E 5 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// side_edge_top_front
E 6 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// side_edge_bottom_front
E 7 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// side_edge_bottom_back
E 8 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// side_edge_top_back
E 9 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// edges_side_walls
E 10 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// line_outflow_top
E 11 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// line_outflow_front
E 12 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// line_outflow_bottom
E 13 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// line_outflow_back
E 14 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
-------------------------------------DESIGN SURF DIRICH CONDITIONS
DSURF  5
// surface_top
E 1 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// surface_bottom
E 2 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// surface_inflow
E 3 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// surface_front
E 4 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
// surface_back
E 5 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 1 0 0 0 0 0
--------------------------------------DESIGN VOL DIRICH CONDITIONS
DVOL   2
// volume_fluid
E 1 - NUMDOF 6 ONOFF 0 0 0 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 0 0 0 0 0 0
// volume_structure
E 2 - NUMDOF 6 ONOFF 0 0 0 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 0 0 0 0 0 0
-----------------------------------------------DNODE-NODE TOPOLOGY
CORNER fluid x- y- z+ DNODE 1
CORNER fluid x- y- z- DNODE 1
CORNER fluid x- y+ z+ DNODE 1
CORNER fluid x- y+ z- DNODE 1
CORNER fluid x+ y- z+ DNODE 2
CORNER fluid x+ y- z- DNODE 2
CORNER fluid x+ y+ z+ DNODE 2
CORNER fluid x+ y+ z- DNODE 2
-----------------------------------------------DLINE-NODE TOPOLOGY
EDGE fluid x- y+ DLINE 1
EDGE fluid x- z+ DLINE 2
EDGE fluid x- y- DLINE 3
EDGE fluid x- z- DLINE 4
EDGE fluid x- y+ DLINE 5
EDGE fluid x- z+ DLINE 5
EDGE fluid x- y- DLINE 5
EDGE fluid x- z- DLINE 5
EDGE fluid y+ z+ DLINE 6
EDGE fluid y- z+ DLINE 7
EDGE fluid y- z- DLINE 8
EDGE fluid y+ y- DLINE 9
EDGE fluid y+ z+ DLINE 10
EDGE fluid y- z+ DLINE 10
EDGE fluid y- z- DLINE 10
EDGE fluid y+ y- DLINE 10
EDGE fluid x+ y+ DLINE 11
EDGE fluid x+ z+ DLINE 12
EDGE fluid x+ y- DLINE 13
EDGE fluid x+ z- DLINE 14
-----------------------------------------------DSURF-NODE TOPOLOGY
SIDE fluid y+ DSURFACE 1
SIDE fluid y- DSURFACE 2
SIDE fluid x- DSURFACE 3
SIDE fluid z+ DSURFACE 4
SIDE fluid z- DSURFACE 5
SIDE fluid x+ DSURFACE 6
------------------------------------------------DVOL-NODE TOPOLOGY
VOLUME fluid DVOL 1
VOLUME fluid DVOL 2
-------------------------------------------------------NODE COORDS
------------------------------------------------STRUCTURE ELEMENTS
----------------------------------------------------FLUID DOMAIN
LOWER_BOUND -0.5 -0.5 -0.5
UPPER_BOUND  0.5  0.5  0.5
INTERVALS   10 10 10
ELEMENTS    FLUID3 HEX8 MAT 1 NA Euler GP 3 3 3 CA No
PARTITION   auto
------------------------------------------------------ALE ELEMENTS
------------------------------------------------TRANSPORT ELEMENTS
---------------------------------------------------THERMO ELEMENTS
---------------------------------------------------------------END
// END
