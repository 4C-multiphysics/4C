//
// Maintainer: Shadan Shahmiri
//
// necessary defines: D_FLUID3 BINIO
//
==================================================================
General Data File BACI
==================================================================
-----------------------------------------------------------------------TITLE
monolithic_structure_split: 1D example
The structure is free at the end.
The velocity fuction is t*t
->linear pressure field
----------------------------------------------------------------PROBLEM SIZE
//ELEMENTS                      6
//NODES                         32
DIM                             3
-----------------------------------------------------------------PROBLEM TYP
PROBLEMTYP                      Fluid_Fluid_FSI
RESTART                         0
--------------------------------------------------------------DISCRETISATION
NUMALEDIS                       0
NUMFLUIDDIS                     1
NUMSTRUCDIS                     0
NUMTHERMDIS                     0
--------------------------------------------------------------------------IO
OUTPUT_GID                      No
OUTPUT_BIN                      Yes
FILESTEPS                       1
FLUID_SOL                       Yes
FLUID_STRESS                    No
FLUID_VIS                       No
STRUCT_DISP                     Yes
STRUCT_STRAIN                   No
STRUCT_STRESS                   No
STRUCT_SURFACTANT               No
THERM_HEATFLUX                  No
THERM_TEMPERATURE               No
THERM_TEMPGRAD                  No
WRITE_TO_SCREEN                 yes
WRITE_TO_FILE                   No
LIMIT_OUTP_TO_PROC              0
---------------------------------------------------------------FLUID DYNAMIC
ADAPTCONV                       yes
ADAPTCONV_BETTER                1
ALPHA_F                         1.00
ALPHA_M                         1.00
CONVCHECK                       L_2_norm
CONVTOL                         1e-07
INITIALFIELD zero_field //field_by_function
ITEMAX                          5
LIFTDRAG                        No
MAXTIME                         50
NONLINITER                      Newton
NUMSTEP                         10000
RESTARTEVRY                     2
SIMPLER                         no
STARTFUNCNO                     2
STARTINGALGO                    One_Step_Theta
START_THETA                     1
STEADYSTEP                      -1
STEADYTOL                       1e-6
THETA                           1.0
TIMEINTEGR                      One_Step_Theta
TIMESTEP                        1
NEUMANNINFLOW                   no
LINEAR_SOLVER                   1
----------------------------------------------------------STRUCTURAL DYNAMIC
DYNAMICTYP                      GenAlpha//OneStepTheta
TIMESTEP                        1
NUMSTEP                         200
MAXTIME                         5.0
NLNSOL                          fullnewton                      // fullnewton modnewton matfreenewton nlncg ptc
DAMPING                         No
M_DAMP                          0.000001
K_DAMP                          0.00001
PREDICT                         ConstDisVelAcc
NORM_DISP                       Rel
NORM_RESF                       Rel
NORMCOMBI_RESFDISP              And
TOLDISP                         1.0E-08
TOLRES                          1.0E-08
TOLCONSTR                       1.0E-06
ADAPTCONV                       No
ADAPTCONV_BETTER                0.1
MAXITER                         100
LINEAR_SOLVER                   1
-------------------------------------------------STRUCTURAL DYNAMIC/GENALPHA
GENAVG                          TrLike
BETA                            0.309//0.25
GAMMA                           0.611//0.5
ALPHA_M                         0.333//0.5
ALPHA_F                         0.444//0.5
-----------------------------------------------------------------ALE DYNAMIC
ALE_TYPE                        incr_lin                        // classic_lin
TIMESTEP                        1
LINEAR_SOLVER                   1
-----------------------------------------------------------------FSI DYNAMIC
LINEARBLOCKSOLVER               PreconditionedKrylov            // FSIAMG PreconditionedKrylov
MAXTIME                         1000.0
TIMESTEP                        0.1
NUMSTEP                         6
RESTARTEVRY                     1
COUPALGO                        iter_fluidfluid_monolithicstructuresplit
RELAX                           1.0
ITEMAX                          7
CONVTOL                         1.0E-7
BASETOL                         1.0E-3
STRUCTPCOMEGA 1.0 1.0
STRUCTPCITER 1 1
FLUIDPCOMEGA 1.0 1.0 1.0
FLUIDPCITER 1 1 1
SHAPEDERIVATIVES                yes
PRECONDREUSE                    0
SECONDORDER                     No
--------------------------------------------------------------------SOLVER 1
SOLVER                          Superlu//UMFPACK//Aztec_MSR     // Aztec_MSR SPOOLES_nonsym Superlu Colsol UMFPACK Amesos_KLU_sym Amesos_KLU_nonsym LAPACK_sym LAPACK_nonsym
AZOUTPUT                        0                               // output every so often, 0 no output
AZSOLVE                         GMRES                           // CG GMRES CGS BiCGSTAB LU TFQMR
AZPREC                          MLFLUID2                        // none ML MLFLUID MLFLUID2 ILU ILUT ICC LU Jacobi SymmGaussSeidel Least_Squares Neumann
AZREUSE                         10                              // how often to recompute some preconditioners
AZDROP                          0.0                             // drop tolerance for ILUT
IFPACKFILL                      1.0                             // fill-in for ILUT
IFPACKGFILL                     0                               // graph fill for ILU
AZTOL                           1.0E-4                          // tolerance in (un)scaled residual
AZCONV                          AZ_r0                           // scale residual for convergence check by AZ_r0 AZ_rhs AZ_Anorm AZ_sol AZ_weighted AZ_expected_values AZ_noscaled AZTECOO_conv_test AZ_inf_noscaled
AZITER                          1200                            // max iterations
AZSUB                           25                              // size of krylov space for gmres
AZOMEGA                         1.0                             // unused
AZGRAPH                         1                               // unused
AZPOLY                          5                               // polynomial order for Neumann
IFPACKOVERLAP                   1                               // amount of ASM overlap for ILU, ILU, ICC, LU
IFPACKCOMBINE                   Zero                            // combine mode: Zero, Insert, Add
AZSCAL                          none                            // none sym infnorm scaling of the system
ML_PRINT                        0                               // ML print-out level (0-10)
ML_MAXCOARSESIZE                1                               // ML stop coarsening when coarse ndof smaller then this
ML_MAXLEVEL                     3                               // ML max number of levels
ML_COARSEN                      UC                              // UC MIS METIS VBMETIS
ML_AGG_SIZE                     27                              // objective size of an aggregate with METIS/VBMETIS, 2D: 9, 3D: 27
ML_PROLONG_SMO                  1.33                            // damping factor for prolongator smoother (usually 1.33 or 0.0)
ML_PROLONG_THRES                0.0                             // threshold for prolongator smoother/aggregation
ML_SMOOTHERFINE                 SGS                             // SGS Jacobi Chebychev MLS ILU KLU
ML_SMOOTHERMED                  ILU                             // SGS Jacobi Chebychev MLS ILU KLU
ML_SMOOTHERCOARSE               Umfpack                         // SGS Jacobi Chebychev MLS KLU Superlu
ML_SMOTIMES 1 4 1 // no. smoothing steps or polynomial order on each level (at least ML_MAXLEVEL numbers)
ML_DAMPFINE                     1.0                             // damping fine grid
ML_DAMPMED                      1.0                             // damping med grids
ML_DAMPCOARSE                   1.0                             // damping coarse grid
----------------------------------------------------------------XFEM GENERAL
GMSH_SOL_OUT                    no
GMSH_EOS_OUT                    no
GMSH_CUT_OUT                    no
GMSH_DEBUG_OUT                  no
//GMSH_EOS_OUT                  no
------------------------------------------------XFLUID DYNAMIC/STABILIZATION
EMBEDDED_BOUNDARY               BoundaryTypeSigma               // "BoundaryTypeTauPressure" "BoundaryTypeNitsche" "BoundaryTypeNeumann" // Which Boundary method shall be used to enforce interface conditions?
CONV_STAB_FAC                   0.0
CONV_STAB_SCALING               none
------------------------------------------------------XFLUID DYNAMIC/GENERAL
MONOLITHIC_XFFSI_APPROACH       xffsi_fixedALE_interpolation
-------------------------------------------------------------------MATERIALS
MAT 1 MAT_fluid DYNVISCOSITY 1.0 DENSITY 1.0 GAMMA 1.0
MAT 2 MAT_Struct_StVenantKirchhoff YOUNG 2000000 NUE 0.4 DENS 2.0 THEXPANS 0.0
--------------------------------------------------------CLONING MATERIAL MAP
SRC_FIELD xfluid SRC_MAT 1 TAR_FIELD ale TAR_MAT 2
----------------------------------------------------------------------CURVE1
CURVE1 on EXPR FUNC t*t t1 0.0 t2 20
----------------------------------------------------------DESIGN DESCRIPTION
NDPOINT                         1
NDLINE                          0
NDSURF                          5
NDVOL                           4
----------------------------------------------DESIGN POINT DIRICH CONDITIONS
DPOINT                          1
// bgFluid inflow
E 1 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 1 0.0 0.0 0.0 0.0 0.0 CURVE 1 none none none none none FUNCT 0 0 0 0 0 0
-----------------------------------------------DESIGN SURF DIRICH CONDITIONS
DSURF                           1
// str dirichlet
E 4 - NUMDOF 6 ONOFF 0 1 1 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 0 0 0 0 0 0
//E 4 - 3 1 1 1 0.1 0.0 0.0 none none none 0 0 0
------------------------------------------------DESIGN VOL DIRICH CONDITIONS
DVOL                            2
// bgfluid volume
E 1 - NUMDOF 6 ONOFF 0 1 1 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 0 0 0 0 0 0
// embedded volume
E 2 - NUMDOF 6 ONOFF 0 1 1 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 0 0 0 0 0 0
--------------------------------------------DESIGN VOL ALE DIRICH CONDITIONS
DVOL                            1
// embedded volume
E 2 - NUMDOF 6 ONOFF 0 1 1 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 CURVE none none none none none none FUNCT 0 0 0 0 0 0
-----------------------------------------DESIGN FSI COUPLING SURF CONDITIONS
DSURF                           1
E 1 - 1
----------------------------------------DESIGN XFEM COUPLING SURF CONDITIONS
DSURF                           1
//                              xfem
E 2 - 1
---------------------------------DESIGN FLUID FLUID COUPLING SURF CONDITIONS
DSURF                           1
//                              fluidfluid
E 3 - 1
------------------------------------------DESIGN MOVING FLUID VOL CONDITIONS
DVOL                            1
// embedded volume
E 2 - 1
---------------------------------------------------------DNODE-NODE TOPOLOGY
NODE 1 DNODE 1
NODE 2 DNODE 1
NODE 3 DNODE 1
NODE 4 DNODE 1
---------------------------------------------------------DLINE-NODE TOPOLOGY
---------------------------------------------------------DSURF-NODE TOPOLOGY
NODE 25 DSURFACE 1
NODE 26 DSURFACE 1
NODE 27 DSURFACE 1
NODE 28 DSURFACE 1
NODE 17 DSURFACE 2
NODE 18 DSURFACE 2
NODE 19 DSURFACE 2
NODE 20 DSURFACE 2
NODE 25 DSURFACE 2
NODE 26 DSURFACE 2
NODE 27 DSURFACE 2
NODE 28 DSURFACE 2
NODE 17 DSURFACE 3
NODE 18 DSURFACE 3
NODE 19 DSURFACE 3
NODE 20 DSURFACE 3
NODE 29 DSURFACE 4
NODE 30 DSURFACE 4
NODE 31 DSURFACE 4
NODE 32 DSURFACE 4
----------------------------------------------------------DVOL-NODE TOPOLOGY
NODE 1 DVOL 1
NODE 2 DVOL 1
NODE 3 DVOL 1
NODE 4 DVOL 1
NODE 5 DVOL 1
NODE 6 DVOL 1
NODE 7 DVOL 1
NODE 8 DVOL 1
NODE 9 DVOL 1
NODE 10 DVOL 1
NODE 11 DVOL 1
NODE 12 DVOL 1
NODE 13 DVOL 1
NODE 14 DVOL 1
NODE 15 DVOL 1
NODE 16 DVOL 1
NODE 17 DVOL 2
NODE 18 DVOL 2
NODE 19 DVOL 2
NODE 20 DVOL 2
NODE 21 DVOL 2
NODE 22 DVOL 2
NODE 23 DVOL 2
NODE 24 DVOL 2
NODE 25 DVOL 2
NODE 26 DVOL 2
NODE 27 DVOL 2
NODE 28 DVOL 2
-----------------------------------------------------------------NODE COORDS
NODE 1 COORD -9.0000000000000002e-01 -2.9999999999999999e-01 2.9999999999999999e-01
NODE 2 COORD -9.0000000000000002e-01 -2.9999999999999999e-01 -2.9999999999999999e-01
NODE 3 COORD -9.0000000000000002e-01 2.9999999999999999e-01 -2.9999999999999999e-01
NODE 4 COORD -9.0000000000000002e-01 2.9999999999999999e-01 2.9999999999999999e-01
NODE 5 COORD -3.0000000000000004e-01 -2.9999999999999999e-01 2.9999999999999999e-01
NODE 6 COORD -2.9999999999999993e-01 -2.9999999999999999e-01 -2.9999999999999999e-01
NODE 7 COORD -3.0000000000000004e-01 2.9999999999999999e-01 -2.9999999999999999e-01
NODE 8 COORD -2.9999999999999993e-01 2.9999999999999999e-01 2.9999999999999999e-01
NODE 9 COORD 2.9999999999999993e-01 -2.9999999999999999e-01 2.9999999999999999e-01
NODE 10 COORD 3.0000000000000004e-01 -2.9999999999999999e-01 -2.9999999999999999e-01
NODE 11 COORD 2.9999999999999993e-01 2.9999999999999999e-01 -2.9999999999999999e-01
NODE 12 COORD 3.0000000000000004e-01 2.9999999999999999e-01 2.9999999999999999e-01
NODE 13 COORD 9.0000000000000002e-01 -2.9999999999999999e-01 2.9999999999999999e-01
NODE 14 COORD 9.0000000000000002e-01 -2.9999999999999999e-01 -2.9999999999999999e-01
NODE 15 COORD 9.0000000000000002e-01 2.9999999999999999e-01 -2.9999999999999999e-01
NODE 16 COORD 9.0000000000000002e-01 2.9999999999999999e-01 2.9999999999999999e-01
NODE 17 COORD 1.5000000000000002e-01 -2.9999999999999999e-01 2.9999999999999999e-01
NODE 18 COORD 1.5000000000000002e-01 -2.9999999999999999e-01 -2.9999999999999999e-01
NODE 19 COORD 1.5000000000000002e-01 2.9999999999999999e-01 -2.9999999999999999e-01
NODE 20 COORD 1.5000000000000002e-01 2.9999999999999999e-01 2.9999999999999999e-01
NODE 21 COORD 7.5000000000000000e-01 -2.9999999999999999e-01 2.9999999999999999e-01
NODE 22 COORD 7.5000000000000000e-01 -2.9999999999999999e-01 -2.9999999999999999e-01
NODE 23 COORD 7.5000000000000000e-01 2.9999999999999999e-01 -2.9999999999999999e-01
NODE 24 COORD 7.5000000000000000e-01 2.9999999999999999e-01 2.9999999999999999e-01
NODE 25 COORD 1.3500000000000001e+00 -2.9999999999999999e-01 2.9999999999999999e-01
NODE 26 COORD 1.3500000000000001e+00 -2.9999999999999999e-01 -2.9999999999999999e-01
NODE 27 COORD 1.3500000000000001e+00 2.9999999999999999e-01 -2.9999999999999999e-01
NODE 28 COORD 1.3500000000000001e+00 2.9999999999999999e-01 2.9999999999999999e-01
NODE 29 COORD 1.9500000000000002e+00 -2.9999999999999999e-01 2.9999999999999999e-01
NODE 30 COORD 1.9500000000000002e+00 -2.9999999999999999e-01 -2.9999999999999999e-01
NODE 31 COORD 1.9500000000000002e+00 2.9999999999999999e-01 -2.9999999999999999e-01
NODE 32 COORD 1.9500000000000002e+00 2.9999999999999999e-01 2.9999999999999999e-01
----------------------------------------------------------STRUCTURE ELEMENTS
1 SOLIDH8 HEX8 25 26 27 28 29 30 31 32 MAT 2 KINEM nonlinear EAS mild
--------------------------------------------------------------FLUID ELEMENTS
2 FLUID3 HEX8 1 2 3 4 5 6 7 8 MAT 1 NA Euler GP 3 3 3 CA No
3 FLUID3 HEX8 5 6 7 8 9 10 11 12 MAT 1 NA Euler GP 3 3 3 CA No
4 FLUID3 HEX8 9 10 11 12 13 14 15 16 MAT 1 NA Euler GP 3 3 3 CA No
5 FLUID3 HEX8 17 18 19 20 21 22 23 24 MAT 1 NA Ale GP 3 3 3 CA No
6 FLUID3 HEX8 21 22 23 24 25 26 27 28 MAT 1 NA Ale GP 3 3 3 CA No
----------------------------------------------------------------ALE ELEMENTS
----------------------------------------------------------TRANSPORT ELEMENTS
-------------------------------------------------------------THERMO ELEMENTS
----------------------------------------------------------RESULT DESCRIPTION
FLUID DIS fluid NODE 8 QUANTITY velx VALUE 3.59999999999990272e-01 TOLERANCE 1e-6
FLUID DIS fluid NODE 8 QUANTITY pressure VALUE 2.81010749143529726e+00 TOLERANCE 1e-6
FLUID DIS fluid NODE 9 QUANTITY velx VALUE 3.60000000000009146e-01 TOLERANCE 1e-6
FLUID DIS fluid NODE 9 QUANTITY pressure VALUE 2.81010749143529903e+00 TOLERANCE 1e-6
FLUID DIS fluid NODE 10 QUANTITY velx VALUE 3.59999999999990272e-01 TOLERANCE 1e-6
FLUID DIS fluid NODE 10 QUANTITY pressure VALUE 2.81010749143529592e+00 TOLERANCE 1e-6
FLUID DIS xfluid NODE 18 QUANTITY velx VALUE 3.59999999999990272e-01 TOLERANCE 1e-6
FLUID DIS xfluid NODE 18 QUANTITY pressure VALUE 2.87500749143528811e+00 TOLERANCE 1e-6
FLUID DIS xfluid NODE 17 QUANTITY velx VALUE 3.59999999999990272e-01 TOLERANCE 1e-6
FLUID DIS xfluid NODE 17 QUANTITY pressure VALUE 2.87500749143529299e+00 TOLERANCE 1e-6
FLUID DIS xfluid NODE 21 QUANTITY velx VALUE 3.59999999999990272e-01 TOLERANCE 1e-6
FLUID DIS xfluid NODE 21 QUANTITY pressure VALUE 2.21500749143528397e+00 TOLERANCE 1e-6
FLUID DIS xfluid NODE 26 QUANTITY velx VALUE 3.59999999999990272e-01 TOLERANCE 1e-6
FLUID DIS xfluid NODE 26 QUANTITY pressure VALUE 1.55500749143533579e+00 TOLERANCE 1e-6
STRUCTURE DIS structure NODE 26 QUANTITY dispx VALUE 9.10000000000045078e-02 TOLERANCE 1e-6
STRUCTURE DIS structure NODE 28 QUANTITY dispx VALUE 9.10000000000044662e-02 TOLERANCE 1e-6
FSI NODE 25 QUANTITY lambdax VALUE 1.39950674487038462e-01 TOLERANCE 1e-8
FSI NODE 25 QUANTITY lambday VALUE 4.66511001004418432e-02 TOLERANCE 1e-8
FSI NODE 25 QUANTITY lambdaz VALUE -4.66511000240792603e-02 TOLERANCE 1e-8
-------------------------------------------------------------------------END
//                              END
