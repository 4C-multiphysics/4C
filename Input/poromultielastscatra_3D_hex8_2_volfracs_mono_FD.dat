//
// Maintainer: Johannes Kremheller
// kremheller@lnm.mw.tum.de
// http://www.lnm.mw.tum.de
//
//
//
==================================================================
                  General Data File BACI
==================================================================
-------------------------------------------------------------TITLE
Framework test for multiphase flow through deformable porous medium.
3 fluid phases, 2 volume fraction phases, 2 scalars
Minimal test for monolithic framework also testing finite difference check
of monolithic system matrix
------------------------------------------------------PROBLEM SIZE
//ELEMENTS    1
//NODES       8
DIM           3
-----------------------------------------------------------------PROBLEM TYP
PROBLEMTYP                      Multiphase_Poroelasticity_ScaTra
RESTART                         0
----------------------------------------------------------POROMULTIPHASESCATRA DYNAMIC
RESULTSEVRY                     10
RESTARTEVRY                     10
NUMSTEP                         20
MAXTIME                         0.2
TIMESTEP                        0.01
ITEMAX                          10
COUPALGO                        twoway_monolithic
--------------------------------------POROMULTIPHASESCATRA DYNAMIC/MONOLITHIC
TOLRES_GLOBAL                   1e-08
TOLINC_GLOBAL                   1e-08
VECTORNORM_RESF                 L2
VECTORNORM_INC                  L2
LINEAR_SOLVER                   1
FDCHECK                         global
----------------------------------------------------------STRUCTURAL DYNAMIC
INT_STRATEGY                    Standard
DYNAMICTYP                      OneStepTheta // OneStepTheta
LINEAR_SOLVER                   1
---------------------------------------------STRUCTURAL DYNAMIC/ONESTEPTHETA
THETA                           0.66
---------------------------------------------POROFLUIDMULTIPHASE DYNAMIC
TIMEINTEGR                      One_Step_Theta
THETA                           0.66
LINEAR_SOLVER                   1
INITIALFIELD                    field_by_function
INITFUNCNO                      1
FLUX_PROJ_METHOD                none
FLUX_PROJ_SOLVER                2
---------------------------------------------POROMULTIPHASE DYNAMIC
ITEMAX                          10
COUPALGO                        twoway_monolithic
----------------------------------------------------SCALAR TRANSPORT DYNAMIC
LINEAR_SOLVER                   1
SOLVERTYPE                      nonlinear
TIMEINTEGR                      One_Step_Theta
THETA                           0.66
VELOCITYFIELD                   Navier_Stokes
VELFUNCNO                       -1
INITIALFIELD                    field_by_function
INITFUNCNO                      2
SKIPINITDER                     yes
CONVFORM                        convective
--------------------------------------SCALAR TRANSPORT DYNAMIC/STABILIZATION
ASSUGRDIFF                      no
CONSISTENCY                     no
DEFINITION_ASSGD                artificial_linear
DEFINITION_TAU                  Zero
EVALUATION_MAT                  integration_point
EVALUATION_TAU                  integration_point
STABTYPE                        no_stabilization
SUGRVEL                         no
---------------------------------------SCALAR TRANSPORT DYNAMIC/NONLINEAR
ITEMAX                          10
CONVTOL                         1e-8
--------------------------------------------------------------------SOLVER 1
NAME                            Solver
SOLVER                          UMFPACK                       // Aztec_MSR vm3 SPOOLES_nonsym Superlu Colsol UMFPACK Amesos_KLU_sym Amesos_KLU_nonsym LAPACK_sym LAPACK_nonsym
-------------------------------------------------------------------MATERIALS
MAT 1 MAT_FluidPoroMultiPhaseReactions LOCAL No PERMEABILITY 1.0 NUMMAT 7 MATIDS 10 20 30 40 50 60 70 NUMFLUIDPHASES 3 NUMREAC 1 REACIDS 15 END

MAT 15 MAT_FluidPoroSingleReaction NUMSCAL 4 TOTALNUMDOF 7 NUMVOLFRAC 2 SCALE 0 -1 1 0 -1 0 1 COUPLING scalar_by_function FUNCTID 3

MAT 10 MAT_FluidPoroSinglePhase DOFTYPEID 100 VISCOSITYLAWID 103 DENSITYLAWID 102 DENSITY 1.0 RELPERMEABILITYLAWID 104
MAT 100 MAT_FluidPoroSinglePhaseDofPressure PHASELAWID 101
MAT 101 MAT_PhaseLawLinear NUMDOF 3 PRESCOEFF 1 1 0   END RELTENSION 0.5 SATURATION_0 0.1
MAT 102 MAT_PoroDensityLawExp BULKMODULUS 1.0
MAT 103 MAT_FluidPoroViscosityLawConstant VALUE 0.01
MAT 104 MAT_FluidPoroRelPermeabilityLawExp EXP 2.0 MIN_SAT 0.0


MAT 20 MAT_FluidPoroSinglePhase DOFTYPEID 200 VISCOSITYLAWID 103 DENSITYLAWID 202 DENSITY 1.0 RELPERMEABILITYLAWID 104
MAT 200 MAT_FluidPoroSinglePhaseDofPressure PHASELAWID 201
MAT 201 MAT_PhaseLawLinear NUMDOF 3 PRESCOEFF 0 1  -1 END RELTENSION 0.5 SATURATION_0 0.2
MAT 202 MAT_PoroDensityLawExp BULKMODULUS 1.0

MAT 30 MAT_FluidPoroSinglePhase DOFTYPEID 300 VISCOSITYLAWID 103 DENSITYLAWID 301 DENSITY 1.0 RELPERMEABILITYLAWID 104
MAT 300 MAT_FluidPoroSinglePhaseDofDiffPressure NUMDOF 3 PRESCOEFF 0 -1 1   END PHASELAWID 302
MAT 301 MAT_PoroDensityLawExp BULKMODULUS 1.0
MAT 302 MAT_PhaseLawConstraint

MAT 2 MAT_StructPoro MATID 210 POROLAWID 211 INITPOROSITY 0.8
MAT 210 MAT_Struct_StVenantKirchhoff YOUNG 10 NUE 0.35 DENS 0.1
MAT 211 MAT_PoroLawConstant
//MAT 211 MAT_PoroLawDensityDependent DENSITYLAWID 212
//MAT 212 MAT_PoroDensityLawExp BULKMODULUS 1e15

MAT 40 MAT_FluidPoroSingleVolFrac DENSITY 0.7 DIFFUSIVITY 0.03 AddScalarDependentFlux YES NUMSCAL 4 SCALARDIFFS -0.5 0.3 0.0 0.0
MAT 50 MAT_FluidPoroSingleVolFrac DENSITY 1.5 DIFFUSIVITY 0.07 AddScalarDependentFlux YES NUMSCAL 4 SCALARDIFFS 0.1 0.0 0.0 0.0

MAT 60 MAT_FluidPoroVolFracPressure PERMEABILITY 1.0 VISCOSITYLAWID 603
MAT 70 MAT_FluidPoroVolFracPressure PERMEABILITY 2.3 VISCOSITYLAWID 603

MAT 603 MAT_FluidPoroViscosityLawConstant VALUE 0.2

MAT 5 MAT_matlist_reactions LOCAL No NUMMAT 4 MATIDS 501 502 503 504 NUMREAC 2 REACIDS 601 602 END
MAT 501 MAT_scatra_multiporo_fluid PHASEID 1 DIFFUSIVITY 0.1
MAT 502 MAT_scatra_multiporo_fluid PHASEID 2 DIFFUSIVITY 0.1 DELTA 1.0
MAT 503 MAT_scatra_multiporo_volfrac PHASEID 4 DIFFUSIVITY 0.5
MAT 504 MAT_scatra_multiporo_volfrac PHASEID 3 DIFFUSIVITY 0.2
MAT 601 MAT_scatra_reaction NUMSCAL 4 STOICH 0 1 0 0 REACCOEFF 1.0 COUPLING by_function ROLE 0 5 0 0
MAT 602 MAT_scatra_reaction NUMSCAL 4 STOICH 0 0 2 -1 REACCOEFF 1.0 COUPLING by_function ROLE 0 0 6 6
--------------------------------------------------------CLONING MATERIAL MAP
SRC_FIELD structure SRC_MAT 2 TAR_FIELD porofluid TAR_MAT 1
SRC_FIELD structure SRC_MAT 2 TAR_FIELD scatra TAR_MAT 5
----------------------------------------------------------------------FUNCT1
COMPONENT 0 FUNCTION 0.1
COMPONENT 1 FUNCTION 0.0
COMPONENT 2 FUNCTION 0.0
COMPONENT 3 FUNCTION 0.01
COMPONENT 4 FUNCTION 0.2
COMPONENT 5 FUNCTION 0.1
COMPONENT 6 FUNCTION 0.2
----------------------------------------------------------------------FUNCT2
COMPONENT 0 FUNCTION 0.5*x+1
COMPONENT 1 FUNCTION 1.0*x+1.0
COMPONENT 2 FUNCTION 0.5*x+1
COMPONENT 3 FUNCTION 1.0*x+1.0
----------------------------------------------------------------------FUNCT3
VARFUNCTION phi1*phi2*porosity
----------------------------------------------------------------------FUNCT4
COMPONENT 0 FUNCTION v
VARIABLE 0 NAME v TYPE multifunction NUMPOINTS 3 TIMES 0.0 1.0 1000.0 DESCRIPTION 1000.0*0.5*(1-cos(t*pi/1.0)) 1000.0
----------------------------------------------------------------------FUNCT5
VARFUNCTION porosity*porosity*S3*VF2+VFP2+VFP1*S1
----------------------------------------------------------------------FUNCT6
VARFUNCTION porosity*S2+VF1
-------------------------------------------------RESULT DESCRIPTION
STRUCTURE DIS structure NODE 1 QUANTITY dispx VALUE 0.0 TOLERANCE 1e-14  // DIRICH VALUE
STRUCTURE DIS structure NODE 2 QUANTITY dispy VALUE 0.0 TOLERANCE 1e-14  // DIRICH VALUE
STRUCTURE DIS structure NODE 3 QUANTITY dispz VALUE 0.0 TOLERANCE 1e-14  // DIRICH VALUE
STRUCTURE DIS structure NODE 6 QUANTITY dispx VALUE 1.15536544084875298e-04 TOLERANCE 1e-12
STRUCTURE DIS structure NODE 7 QUANTITY dispy VALUE 9.17637873713544341e-04 TOLERANCE 1e-12
STRUCTURE DIS structure NODE 8 QUANTITY dispz VALUE 9.17637873713496202e-04 TOLERANCE 1e-12
POROFLUIDMULTIPHASE DIS porofluid NODE 5 QUANTITY phi1 VALUE 0.1 TOLERANCE 1e-14  // DIRICH VALUE
POROFLUIDMULTIPHASE DIS porofluid NODE 6 QUANTITY pressure2 VALUE 0.0 TOLERANCE 1e-14  // DIRICH VALUE
POROFLUIDMULTIPHASE DIS porofluid NODE 1 QUANTITY saturation1 VALUE 8.32521412441866837e-01 TOLERANCE 1e-12
POROFLUIDMULTIPHASE DIS porofluid NODE 2 QUANTITY pressure2 VALUE 9.02341997891660808e-01 TOLERANCE 1e-12
POROFLUIDMULTIPHASE DIS porofluid NODE 3 QUANTITY phi3 VALUE -1.08467096884183634e+00 TOLERANCE 1e-12
POROFLUIDMULTIPHASE DIS porofluid NODE 4 QUANTITY phi1 VALUE 5.62700826992072578e-01 TOLERANCE 1e-12
POROFLUIDMULTIPHASE DIS porofluid NODE 1 QUANTITY phi4 VALUE 5.08469240213256124e-01 TOLERANCE 1e-12
POROFLUIDMULTIPHASE DIS porofluid NODE 2 QUANTITY phi5 VALUE 6.33387969669888085e-01 TOLERANCE 1e-12
POROFLUIDMULTIPHASE DIS porofluid NODE 3 QUANTITY phi6 VALUE -3.74201927132109480e-01 TOLERANCE 1e-12
POROFLUIDMULTIPHASE DIS porofluid NODE 4 QUANTITY phi7 VALUE -4.09728596452539704e-03 TOLERANCE 1e-12
SCATRA DIS scatra NODE 1 QUANTITY phi1 VALUE 0.75 TOLERANCE 1e-14  // DIRICH VALUE
SCATRA DIS scatra NODE 4 QUANTITY phi2 VALUE 0.5 TOLERANCE 1e-14  // DIRICH VALUE
SCATRA DIS scatra NODE 1 QUANTITY phi3 VALUE 0.75 TOLERANCE 1e-14  // DIRICH VALUE
SCATRA DIS scatra NODE 4 QUANTITY phi4 VALUE 0.5 TOLERANCE 1e-14  // DIRICH VALUE
SCATRA DIS scatra NODE 5 QUANTITY phi1 VALUE 7.50034522039232376e-01 TOLERANCE 1e-12
SCATRA DIS scatra NODE 6 QUANTITY phi2 VALUE 1.08685151331700824e+00 TOLERANCE 1e-12
SCATRA DIS scatra NODE 7 QUANTITY phi3 VALUE 1.99797235429659215e+00  TOLERANCE 1e-12
SCATRA DIS scatra NODE 8 QUANTITY phi4 VALUE -2.11714048932154219e+03 TOLERANCE 1e-09
------------------------------------------------DESIGN DESCRIPTION
NDPOINT 0
NDLINE  0
NDSURF  2
NDVOL   1
-------------------------------DESIGN SURF PORO NEUMANN CONDITIONS
DSURF  1
// leftsurf
E 1 - NUMDOF 7 ONOFF 1 1 1 1 1 0 0 VAL 0.1 0.2 0.3 0.025 0.025 0.0 0.0 FUNCT 4 4 4 4 4 0 0
-------------------------------------DESIGN SURF DIRICH CONDITIONS
DSURF  1
// leftsurf
E 1 - NUMDOF 3 ONOFF 1 1 1 VAL 0.0 0.0 0.0 FUNCT 0 0 0
-------------------------------------DESIGN SURF TRANSPORT DIRICH CONDITIONS
DSURF  1
// leftsurf
E 1 - NUMDOF 4 ONOFF 1 1 1 1  VAL 0.75 0.5 0.75 0.5 FUNCT 0 0 0 0
--------------------------------DESIGN SURF PORO DIRICH CONDITIONS
DSURF  1
// rightsurf
E 2 - NUMDOF 7 ONOFF 1 1 1 1 1 1 1 VAL 0.1 0.0 0.0 0.0 0.2 0.1 0.2 FUNCT 0 0 0 0 0 0 0
-----------------------------------------------DNODE-NODE TOPOLOGY
-----------------------------------------------DLINE-NODE TOPOLOGY
-----------------------------------------------DSURF-NODE TOPOLOGY
NODE    1 DSURFACE 1
NODE    2 DSURFACE 1
NODE    3 DSURFACE 1
NODE    4 DSURFACE 1
NODE    5 DSURFACE 2
NODE    6 DSURFACE 2
NODE    7 DSURFACE 2
NODE    8 DSURFACE 2
------------------------------------------------DVOL-NODE TOPOLOGY
NODE    1 DVOL 1
NODE    2 DVOL 1
NODE    3 DVOL 1
NODE    4 DVOL 1
NODE    5 DVOL 1
NODE    6 DVOL 1
NODE    7 DVOL 1
NODE    8 DVOL 1
-------------------------------------------------------NODE COORDS
NODE         1 COORD -5.0000000000000000e-01 -5.0000000000000000e-01  5.0000000000000000e-01
NODE         2 COORD -5.0000000000000000e-01 -5.0000000000000000e-01 -5.0000000000000000e-01
NODE         3 COORD -5.0000000000000000e-01  5.0000000000000000e-01 -5.0000000000000000e-01
NODE         4 COORD -5.0000000000000000e-01  5.0000000000000000e-01  5.0000000000000000e-01
NODE         5 COORD  5.0000000000000000e-01 -5.0000000000000000e-01  5.0000000000000000e-01
NODE         6 COORD  5.0000000000000000e-01 -5.0000000000000000e-01 -5.0000000000000000e-01
NODE         7 COORD  5.0000000000000000e-01  5.0000000000000000e-01 -5.0000000000000000e-01
NODE         8 COORD  5.0000000000000000e-01  5.0000000000000000e-01  5.0000000000000000e-01
------------------------------------------------STRUCTURE ELEMENTS
   1 SOLIDH8POROSCATRA HEX8  1 2 3 4 5 6 7 8    MAT 2 KINEM nonlinear EAS none TYPE PoroMultiReac
----------------------------------------------------FLUID ELEMENTS
------------------------------------------------------ALE ELEMENTS
------------------------------------------------LUBRICATION ELEMENTS
------------------------------------------------TRANSPORT ELEMENTS
------------------------------------------------TRANSPORT2 ELEMENTS
---------------------------------------------------THERMO ELEMENTS
---------------------------------------------------ACOUSTIC ELEMENTS
---------------------------------------------------CELL ELEMENTS
---------------------------------------------------CELLSCATRA ELEMENTS
---------------------------------------------------------------END
// END
