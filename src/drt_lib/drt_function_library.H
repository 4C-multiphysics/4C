/*----------------------------------------------------------------------*/
/*!

\brief Special functions for selective laser melting

\level 2

\maintainer Sebastian Proell

*/
/*----------------------------------------------------------------------*/



#include "drt_function.H"

namespace DRT
{
  namespace UTILS
  {
    /**
     * @brief translation of a function's coordinate system by another function
     *
     * This class defines a translated function generated by the composition of a local and an
     * origin function. The origin function \f$ g(x) \f$ determines the location of the coordinate
     * system used for evaluation of the local function \f$ g(x) \f$. Mathematically, the translated
     * function \f$ t(x,t) \f$ can be written as,
     *
     * \f[
     *    t(x,t) = f(g(x,t),t)
     * \f]
     *
     * Thus, \f$ g(x) \f$ is required to have three components for the three spatial dimensions.
     */
    class TranslatedFunction : public Function
    {
     public:
      /**
       * Construct a
       *
       * @param origin function describing the position of the local origin
       * @param local function describing the
       */
      TranslatedFunction(Teuchos::RCP<Function> origin, Teuchos::RCP<Function> local);

      /**
       * \brief Evaluation of the translated function
       *
       * Evaluate the specified component of the translated function at the specified position and
       * point in time.
       *
       * @param index (i) For vector-valued functions, index defines the
                       function-component which should be evaluated
       * @param t     (i) The point in time in which the
                       function will be evaluated
       * @param x     (i) The point in 3-dimensional space in which the
                       function will be evaluated
       */
      double Evaluate(const int index, const double* x, double t) override;

      //! number of spatial dimensions required to shift the origin
      const static int nsd = 3;

     private:
      Teuchos::RCP<Function> originFunction_;
      Teuchos::RCP<Function> localFunction_;
    };
  }  // namespace UTILS
}  // namespace DRT
